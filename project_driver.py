"""
#  EoR_research/project_driver.py

  Author : Hugo Baraer
  Supervision by : Prof. Adrian Liu
  Affiliation : Cosmic dawn group at McGill University
  Date of creation : 2021-09-21

  This module is the driver and interacts between 21cmFast and the modules computing the require fields and parameters.
"""


#import classic python librairies
import py21cmfast as p21c
from py21cmfast import plotting
import os
import numpy as np
import matplotlib.pyplot as plt
from tqdm import tqdm
import emcee
import imageio
import corner
import powerbox as pbox
#import this project's modules
import z_re_field as zre
import Gaussian_testing as gauss
import FFT
import statistical_analysis as sa
import plot_params as pp
import statistics
from numpy import array
#import pyfftw
import zreion.src.zreion as zr

#zre_test = apply_zreion()
# pyfftw.interfaces.cache.enable()
# pyfftw.interfaces.cache.set_keepalive_time(30)
# pyfftw.config.NUM_THREADS <=0
# pyfftw.config.PLANNER_EFFORT = 'FFTW_MEASURE'
# PYFFTW_USE_PTHREADS

varying_input = 'F_star'
#varying_input = 'Turnover_Mass'
data_dict = {'Z_re': [], '{}'.format(varying_input): [], "medians": [], "a16":[], "a50":[], "a84":[], "b16":[], "b50":[], "b84":[], "k16":[], "k50":[], "k84":[], "p16":[], "p50":[], "p84":[], "width50":[],"width90":[]}
ionization_rates = []

z_reion_zre= np.load('zreion_for_Hugo.npz')['zreion']
reion_hist_zreion = pp.reionization_history(np.linspace(5, 15, 100), z_reion_zre, plot = False)

z_re_box= np.load('zre.npy')
density_field = np.load('density.npy')
overzre, zre_mean = zre.over_zre_field(z_re_box)
zre_zreion = zr.apply_zreion(density_field, zre_mean, 1.42,1.16,100)
reion_hist_zreion_0593 = pp.reionization_history(np.linspace(5, 15, 100), zre_zreion, plot=False)




#turnover_mass from 9 to 10
dictt = {'Z_re': [8.015, 8.015, 8.015, 8.015, 8.015], 'Turnover_Mass': [9.0, 9.25, 9.5, 9.75, 10.0], 'medians': [array([1.37544872, 1.06833222, 1.34758923, 0.07819836]), array([2.42005959, 1.17496551, 2.10835368, 0.0890607 ]), array([2.84975847, 1.36030028, 1.35424606, 0.1238452 ]), array([3.20034861, 1.40711272, 1.44129636, 0.13136948]), array([2.52741515, 1.54452263, 1.27588699, 0.11961613])], 'a16': [array([1.32256327]), array([1.55079432]), array([1.95085352]), array([2.32659106]), array([2.50098913])], 'a50': [array([2.19435351]), array([2.35678927]), array([2.55324537]), array([2.78564057]), array([2.90046741])], 'a84': [array([3.04776592]), array([3.12281641]), array([3.1906253]), array([3.25583148]), array([3.31024254])], 'b16': [array([1.03486977]), array([1.13269246]), array([1.26561074]), array([1.34715814]), array([1.38042276])], 'b50': [array([1.06476153]), array([1.19223147]), array([1.3486366]), array([1.42501258]), array([1.44744106])], 'b84': [array([1.14173624]), array([1.32903976]), array([1.49540774]), array([1.53089707]), array([1.54022083])], 'k16': [array([0.85161506]), array([0.95065566]), array([1.05504464]), array([1.2254742]), array([1.35220317])], 'k50': [array([1.74621956]), array([1.67153275]), array([1.5222217]), array([1.54535649]), array([1.63880884])], 'k84': [array([2.64179065]), array([2.47203839]), array([2.05834687]), array([1.95704447]), array([1.98044365])], 'p16': [array([0.05770627]), array([0.09339397]), array([0.11863769]), array([0.12221058]), array([0.10305789])], 'p50': [array([0.06792803]), array([0.10942193]), array([0.13272323]), array([0.13603039]), array([0.11947606])], 'p84': [array([0.0816837]), array([0.12815217]), array([0.14450779]), array([0.14575766]), array([0.13707018])], 'width50': [1.8383838383838382, 1.6262626262626254, 1.6262626262626263, 1.6969696969696972, 1.2727272727272725], 'width90': [5.515151515151516, 5.373737373737374, 4.949494949494948, 4.313131313131313, 3.8888888888888893]}
ion_rates = [[0.9739642234629765, 0.9739642234629765, 0.9739642234629765, 0.9523443449796817, 0.9523443449796817, 0.9523443449796817, 0.9203319053678485, 0.9203319053678485, 0.9203319053678485, 0.8760563120189507, 0.8760563120189507, 0.8760563120189507, 0.8203680519197171, 0.8203680519197171, 0.8203680519197171, 0.7586641438174521, 0.7586641438174521, 0.7586641438174521, 0.6921230268582217, 0.6921230268582217, 0.6921230268582217, 0.6256496205637972, 0.6256496205637972, 0.6256496205637972, 0.561548139375906, 0.561548139375906, 0.5025759120335872, 0.5025759120335872, 0.5025759120335872, 0.4501257947881255, 0.4501257947881255, 0.4501257947881255, 0.40300874732876296, 0.40300874732876296, 0.40300874732876296, 0.3543794950220692, 0.3543794950220692, 0.3543794950220692, 0.29388856534438224, 0.29388856534438224, 0.29388856534438224, 0.2567249856114837, 0.2567249856114837, 0.2567249856114837, 0.22816408003947736, 0.22816408003947736, 0.22816408003947736, 0.20342951097511222, 0.20342951097511222, 0.20342951097511222, 0.18104053509207796, 0.18104053509207796, 0.1612303780135948, 0.1612303780135948, 0.1612303780135948, 0.1437258032690572, 0.1437258032690572, 0.1437258032690572, 0.12802513638740348, 0.12802513638740348, 0.12802513638740348, 0.11419608803343949, 0.11419608803343949, 0.11419608803343949, 0.10191002210171851, 0.10191002210171851, 0.10191002210171851, 0.09100039771466246, 0.09100039771466246, 0.09100039771466246, 0.08120321167413935, 0.08120321167413935, 0.08120321167413935, 0.07236594399780864, 0.07236594399780864, 0.07236594399780864, 0.06446397262574093, 0.06446397262574093, 0.05740975245596498, 0.05740975245596498, 0.05740975245596498, 0.05103434879952069, 0.05103434879952069, 0.05103434879952069, 0.0452915952940404, 0.0452915952940404, 0.0452915952940404, 0.03992261833721074, 0.03992261833721074, 0.03992261833721074, 0.035061129393370576, 0.035061129393370576, 0.035061129393370576, 0.030544349288542157, 0.030544349288542157, 0.030544349288542157, 0.021438632764369966, 0.021438632764369966, 0.021438632764369966, 0.018157059332666942], [0.9222633691800888, 0.9222633691800888, 0.9222633691800888, 0.8778533804207431, 0.8778533804207431, 0.8778533804207431, 0.8213399393408196, 0.8213399393408196, 0.8213399393408196, 0.7582551440441802, 0.7582551440441802, 0.7582551440441802, 0.6903639174654872, 0.6903639174654872, 0.6903639174654872, 0.6215664622921702, 0.6215664622921702, 0.6215664622921702, 0.5554367389175937, 0.5554367389175937, 0.5554367389175937, 0.49386380649523104, 0.49386380649523104, 0.49386380649523104, 0.43895934863708347, 0.43895934863708347, 0.37712959445073485, 0.37712959445073485, 0.37712959445073485, 0.32103643825488415, 0.32103643825488415, 0.32103643825488415, 0.2824246026358599, 0.2824246026358599, 0.2824246026358599, 0.24962836078294046, 0.24962836078294046, 0.24962836078294046, 0.22160982447549027, 0.22160982447549027, 0.22160982447549027, 0.19718303116024277, 0.19718303116024277, 0.19718303116024277, 0.17526768795779504, 0.17526768795779504, 0.17526768795779504, 0.15591338096106055, 0.15591338096106055, 0.15591338096106055, 0.13869845739374811, 0.13869845739374811, 0.12348783789930057, 0.12348783789930057, 0.12348783789930057, 0.11009172743242869, 0.11009172743242869, 0.11009172743242869, 0.09814079509419135, 0.09814079509419135, 0.09814079509419135, 0.08744353597402646, 0.08744353597402646, 0.08744353597402646, 0.07798832298807848, 0.07798832298807848, 0.07798832298807848, 0.06935179349478338, 0.06935179349478338, 0.06935179349478338, 0.06155959547323428, 0.06155959547323428, 0.06155959547323428, 0.05456864031855474, 0.05456864031855474, 0.05456864031855474, 0.04818024168603659, 0.04818024168603659, 0.042439540018883753, 0.042439540018883753, 0.042439540018883753, 0.037106470232784475, 0.037106470232784475, 0.037106470232784475, 0.03213486596537112, 0.03213486596537112, 0.03213486596537112, 0.021512498944158194, 0.021512498944158194, 0.021512498944158194, 0.016503961586850725, 0.016503961586850725, 0.016503961586850725, 0.012672837456445457, 0.012672837456445457, 0.012672837456445457, 0.01051190972458516, 0.01051190972458516, 0.01051190972458516, 0.007818187973696801], [0.8238934521393322, 0.8238934521393322, 0.8238934521393322, 0.7591305950638926, 0.7591305950638926, 0.7591305950638926, 0.6893431278975805, 0.6893431278975805, 0.6893431278975805, 0.6178943556321423, 0.6178943556321423, 0.6178943556321423, 0.5492237724620727, 0.5492237724620727, 0.5492237724620727, 0.4827513920868119, 0.4827513920868119, 0.4827513920868119, 0.4082364894140531, 0.4082364894140531, 0.4082364894140531, 0.35597343142944393, 0.35597343142944393, 0.35597343142944393, 0.3142021067592, 0.3142021067592, 0.2763880942764996, 0.2763880942764996, 0.2763880942764996, 0.2434396744142942, 0.2434396744142942, 0.2434396744142942, 0.2155548495711829, 0.2155548495711829, 0.2155548495711829, 0.19128980951074942, 0.19128980951074942, 0.19128980951074942, 0.16981663746786735, 0.16981663746786735, 0.16981663746786735, 0.1507670284627593, 0.1507670284627593, 0.1507670284627593, 0.1339217777674426, 0.1339217777674426, 0.1339217777674426, 0.11888966820748326, 0.11888966820748326, 0.11888966820748326, 0.10571105260332117, 0.10571105260332117, 0.09391229827436977, 0.09391229827436977, 0.09391229827436977, 0.08345202648102545, 0.08345202648102545, 0.08345202648102545, 0.0740775191359572, 0.0740775191359572, 0.0740775191359572, 0.06548989178946633, 0.06548989178946633, 0.06548989178946633, 0.05782866944781953, 0.05782866944781953, 0.05782866944781953, 0.05066741171196157, 0.05066741171196157, 0.05066741171196157, 0.04409297973775454, 0.04409297973775454, 0.04409297973775454, 0.03812281415098179, 0.03812281415098179, 0.03812281415098179, 0.02626455651053431, 0.02626455651053431, 0.020553264526074932, 0.020553264526074932, 0.020553264526074932, 0.01729904893873792, 0.01729904893873792, 0.01729904893873792, 0.012812362462712112, 0.012812362462712112, 0.012812362462712112, 0.00961388848327085, 0.00961388848327085, 0.00961388848327085, 0.007945059976944177, 0.007945059976944177, 0.007945059976944177, 0.00571949933776918, 0.00571949933776918, 0.00571949933776918, 0.004727435506446705, 0.004727435506446705, 0.004727435506446705, 0.003327055847961516], [0.6892507951728452, 0.6892507951728452, 0.6892507951728452, 0.6140594697981367, 0.6140594697981367, 0.6140594697981367, 0.5337412843892378, 0.5337412843892378, 0.5337412843892378, 0.4588225115390258, 0.4588225115390258, 0.4588225115390258, 0.4015844295564575, 0.4015844295564575, 0.4015844295564575, 0.35219668101471613, 0.35219668101471613, 0.35219668101471613, 0.30999959989152615, 0.30999959989152615, 0.30999959989152615, 0.27248686566990643, 0.27248686566990643, 0.27248686566990643, 0.23918826539981608, 0.23918826539981608, 0.21129694306866784, 0.21129694306866784, 0.21129694306866784, 0.18727025822727325, 0.18727025822727325, 0.18727025822727325, 0.16619514281991665, 0.16619514281991665, 0.16619514281991665, 0.1474177443662504, 0.1474177443662504, 0.1474177443662504, 0.13077904539589708, 0.13077904539589708, 0.13077904539589708, 0.11609267059411321, 0.11609267059411321, 0.11609267059411321, 0.1029143969630057, 0.1029143969630057, 0.1029143969630057, 0.09128389337690526, 0.09128389337690526, 0.09128389337690526, 0.08090569511665897, 0.08090569511665897, 0.07148844113976884, 0.07148844113976884, 0.07148844113976884, 0.06296168499699235, 0.06296168499699235, 0.06296168499699235, 0.0551578598915877, 0.0551578598915877, 0.0551578598915877, 0.04790119167350328, 0.04790119167350328, 0.04790119167350328, 0.04116227066004561, 0.04116227066004561, 0.04116227066004561, 0.02777163176204694, 0.02777163176204694, 0.02777163176204694, 0.02105972661990071, 0.02105972661990071, 0.02105972661990071, 0.0158165957471547, 0.0158165957471547, 0.0158165957471547, 0.011910237544742899, 0.011910237544742899, 0.009862502893946974, 0.009862502893946974, 0.009862502893946974, 0.007068583038068099, 0.007068583038068099, 0.007068583038068099, 0.005138487118046021, 0.005138487118046021, 0.005138487118046021, 0.004179594673017335, 0.004179594673017335, 0.004179594673017335, 0.003389294943894191, 0.003389294943894191, 0.003389294943894191, 0.002321997040565186, 0.002321997040565186, 0.002321997040565186, 0.0018357113569593398, 0.0018357113569593398, 0.0018357113569593398, 0.001260170706109383], [0.5274264099634534, 0.5274264099634534, 0.5274264099634534, 0.45937616591438296, 0.45937616591438296, 0.45937616591438296, 0.40049148367403536, 0.40049148367403536, 0.40049148367403536, 0.35017151658552215, 0.35017151658552215, 0.35017151658552215, 0.30741120584144693, 0.30741120584144693, 0.30741120584144693, 0.2701758117670876, 0.2701758117670876, 0.2701758117670876, 0.2365872183467176, 0.2365872183467176, 0.2365872183467176, 0.20864254821905562, 0.20864254821905562, 0.20864254821905562, 0.18467434076999337, 0.18467434076999337, 0.16374558982999493, 0.16374558982999493, 0.16374558982999493, 0.14523766614333392, 0.14523766614333392, 0.14523766614333392, 0.128796627598525, 0.128796627598525, 0.128796627598525, 0.1141878806801297, 0.1141878806801297, 0.1141878806801297, 0.1010629548455359, 0.1010629548455359, 0.1010629548455359, 0.08936952821739363, 0.08936952821739363, 0.08936952821739363, 0.07886924557666403, 0.07886924557666403, 0.07886924557666403, 0.06940343142602422, 0.06940343142602422, 0.06940343142602422, 0.06071423808232454, 0.06071423808232454, 0.05274011039574148, 0.05274011039574148, 0.05274011039574148, 0.04529091134793125, 0.04529091134793125, 0.04529091134793125, 0.03051459763279412, 0.03051459763279412, 0.03051459763279412, 0.02300999895014272, 0.02300999895014272, 0.02300999895014272, 0.017058983854426175, 0.017058983854426175, 0.017058983854426175, 0.012434482237406586, 0.012434482237406586, 0.012434482237406586, 0.009117001634973174, 0.009117001634973174, 0.009117001634973174, 0.007510412224579177, 0.007510412224579177, 0.007510412224579177, 0.005284851585404179, 0.005284851585404179, 0.0037610196542173656, 0.0037610196542173656, 0.0037610196542173656, 0.002960460733456968, 0.002960460733456968, 0.002960460733456968, 0.0023589301304593004, 0.0023589301304593004, 0.0023589301304593004, 0.0015617909402446545, 0.0015617909402446545, 0.0015617909402446545, 0.0011852786071574277, 0.0011852786071574277, 0.0011852786071574277, 0.0007896157830139932, 0.0007896157830139932, 0.0007896157830139932, 0.0006011886299430923, 0.0006011886299430923, 0.0006011886299430923, 0.00044627483622055485]]


#heff from 100 to 200
dictt = {'Z_re': [8.015, 8.015, 8.015, 8.015, 8.015], 'Heff': [100.0, 125.0, 150.0, 175.0, 200.0], 'medians': [array([2.98838407, 1.05401888, 1.80372087, 0.0456901 ]), array([1.40748982, 1.11420463, 0.78777843, 0.04873756]), array([3.16588227, 1.01848751, 2.21230494, 0.05046035]), array([1.75024559, 1.11215066, 0.91117716, 0.04596911]), array([1.74616803, 1.02127512, 1.23106944, 0.05096637])], 'a16': [array([1.56231736]), array([1.49486456]), array([1.57648945]), array([1.66900535]), array([1.71739708])], 'a50': [array([2.31541097]), array([2.30702687]), array([2.341354]), array([2.43644419]), array([2.48870108])], 'a84': [array([3.08954868]), array([3.1033316]), array([3.11942312]), array([3.14503052]), array([3.17769239])], 'b16': [array([1.03708093]), array([1.0393376]), array([1.03923655]), array([1.0396533]), array([1.03815357])], 'b50': [array([1.06183337]), array([1.06680607]), array([1.06593172]), array([1.06385914]), array([1.06105968])], 'b84': [array([1.11713134]), array([1.13770426]), array([1.1276074]), array([1.11553986]), array([1.11055899])], 'k16': [array([0.86547827]), array([0.75289955]), array([0.7946504]), array([0.85233284]), array([0.8696354])], 'k50': [array([1.48798275]), array([1.40675298]), array([1.39212657]), array([1.42310926]), array([1.44086232])], 'k84': [array([2.14637927]), array([2.0702159]), array([2.01353726]), array([1.97646781]), array([1.97389687])], 'p16': [array([0.04061677]), array([0.04064436]), array([0.04084153]), array([0.04166355]), array([0.04140899])], 'p50': [array([0.04779829]), array([0.04796154]), array([0.04818384]), array([0.04907962]), array([0.04903712])], 'p84': [array([0.05762573]), array([0.05761268]), array([0.0582661]), array([0.05926778]), array([0.05921958])], 'width50': [1.8181818181818166, 2.0202020202020208, 1.8181818181818166, 1.8181818181818201, 1.8181818181818183], 'width90': [5.454545454545454, 5.6565656565656575, 5.454545454545455, 5.252525252525253, 5.252525252525251]}
ion_rates = [[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999945284311268, 0.9999945284311268, 0.9998242258499483, 0.9998242258499483, 0.9992688616093184, 0.9992688616093184, 0.9978513832981044, 0.9978513832981044, 0.9951036298045932, 0.9951036298045932, 0.9907031205383203, 0.9907031205383203, 0.983667708886546, 0.983667708886546, 0.9721196208065982, 0.9721196208065982, 0.9550004496945668, 0.9550004496945668, 0.9310059103203022, 0.9310059103203022, 0.8994216209727971, 0.8994216209727971, 0.8587637605682498, 0.8587637605682498, 0.8098790543897885, 0.8098790543897885, 0.7564009661422738, 0.7564009661422738, 0.6983944707060752, 0.6983944707060752, 0.6375174534497728, 0.6375174534497728, 0.5777754447616055, 0.5777754447616055, 0.5193428508994062, 0.5193428508994062, 0.46513362426120997, 0.46513362426120997, 0.416303291798426, 0.416303291798426, 0.36808714294165906, 0.36808714294165906, 0.3150905527549862, 0.3150905527549862, 0.2696874742451543, 0.2696874742451543, 0.23575724974326373, 0.23575724974326373, 0.20870102561138798, 0.20870102561138798, 0.184745471165345, 0.184745471165345, 0.16382561152476552, 0.16382561152476552, 0.14523116865529698, 0.14523116865529698, 0.12855382672977667, 0.12855382672977667, 0.11397448949407481, 0.11397448949407481, 0.10095796911778133, 0.10095796911778133, 0.08954769617882728, 0.08954769617882728, 0.07953882881752215, 0.07953882881752215, 0.07069916732980941, 0.07069916732980941, 0.06282523774821687, 0.06282523774821687, 0.055764520090403995, 0.055764520090403995, 0.04950265148807865, 0.04950265148807865, 0.043912417964938874, 0.043912417964938874, 0.03897330113771016, 0.03897330113771016, 0.03456082281452715, 0.03456082281452715, 0.030614111791675485, 0.030614111791675485, 0.027040151398310723, 0.027040151398310723, 0.0237021524126028, 0.0237021524126028, 0.020619949271717085, 0.020619949271717085, 0.01422265933977998, 0.01422265933977998, 0.011773448322912845, 0.011773448322912845, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999630669101058, 0.9999630669101058, 0.9996549491879337, 0.9996549491879337, 0.9989744228093291, 0.9989744228093291, 0.9971024623085849, 0.9971024623085849, 0.9939792224011501, 0.9939792224011501, 0.9889252026275842, 0.9889252026275842, 0.9810105782524972, 0.9810105782524972, 0.9679232694539066, 0.9679232694539066, 0.9493397697221845, 0.9493397697221845, 0.9234048752362606, 0.9234048752362606, 0.8898080744625808, 0.8898080744625808, 0.846819667691104, 0.846819667691104, 0.7960106791345483, 0.7960106791345483, 0.7412371969563031, 0.7412371969563031, 0.6819749764637045, 0.6819749764637045, 0.6203445925681732, 0.6203445925681732, 0.5601125364927996, 0.5601125364927996, 0.501698751148602, 0.501698751148602, 0.44838378404811974, 0.44838378404811974, 0.3993154383393515, 0.3993154383393515, 0.3479784433865318, 0.3479784433865318, 0.2956733227162099, 0.2956733227162099, 0.2552363769049181, 0.2552363769049181, 0.22384017273742932, 0.22384017273742932, 0.19758450752631398, 0.19758450752631398, 0.1745037201538742, 0.1745037201538742, 0.154333807421978, 0.154333807421978, 0.1364677671587545, 0.1364677671587545, 0.12050036129453216, 0.12050036129453216, 0.10645792175451327, 0.10645792175451327, 0.09425427132894491, 0.09425427132894491, 0.08345954988822611, 0.08345954988822611, 0.07387746489903074, 0.07387746489903074, 0.06548681403197516, 0.06548681403197516, 0.05803590511889206, 0.05803590511889206, 0.051382819342132756, 0.051382819342132756, 0.04555491454606326, 0.04555491454606326, 0.040397960883070176, 0.040397960883070176, 0.03580560473318065, 0.03580560473318065, 0.03172518224599011, 0.03172518224599011, 0.027977499540901174, 0.027977499540901174, 0.02459196630060731, 0.02459196630060731, 0.02139793797087552, 0.02139793797087552, 0.01835061608155647, 0.01835061608155647, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999931605389085, 0.9999931605389085, 0.9998119148199837, 0.9998119148199837, 0.9992774109356828, 0.9992774109356828, 0.9979228556665106, 0.9979228556665106, 0.9952482844066785, 0.9952482844066785, 0.9911210116110111, 0.9911210116110111, 0.9844699776725793, 0.9844699776725793, 0.9737217645672827, 0.9737217645672827, 0.9573833179388463, 0.9573833179388463, 0.9345682436298114, 0.9345682436298114, 0.9042075338715762, 0.9042075338715762, 0.8650721375059973, 0.8650721375059973, 0.8166487529781579, 0.8166487529781579, 0.7631046639311102, 0.7631046639311102, 0.7052896734054737, 0.7052896734054737, 0.6433214201320221, 0.6433214201320221, 0.5820193303688829, 0.5820193303688829, 0.5220102407250923, 0.5220102407250923, 0.46569787980125893, 0.46569787980125893, 0.4151063861074131, 0.4151063861074131, 0.3637799923192852, 0.3637799923192852, 0.30979988762765426, 0.30979988762765426, 0.26549043894635366, 0.26549043894635366, 0.2313297246056794, 0.2313297246056794, 0.2033238413012485, 0.2033238413012485, 0.1789425304022595, 0.1789425304022595, 0.1579224726566895, 0.1579224726566895, 0.13921825643670233, 0.13921825643670233, 0.12269993198155944, 0.12269993198155944, 0.10813495761414975, 0.10813495761414975, 0.09522752664226575, 0.09522752664226575, 0.08394446767961365, 0.08394446767961365, 0.07404263788439054, 0.07404263788439054, 0.06538661592698465, 0.06538661592698465, 0.05772641950450156, 0.05772641950450156, 0.05095843078140501, 0.05095843078140501, 0.04496535299997572, 0.04496535299997572, 0.039708201231992125, 0.039708201231992125, 0.03504881836340588, 0.03504881836340588, 0.030783730426744756, 0.030783730426744756, 0.027024420637800264, 0.027024420637800264, 0.02347986992712896, 0.02347986992712896, 0.020097414444326275, 0.020097414444326275, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9998539775056964, 0.9998539775056964, 0.9993502511963073, 0.9993502511963073, 0.9981714700771868, 0.9981714700771868, 0.9956641236410418, 0.9956641236410418, 0.9918251341303813, 0.9918251341303813, 0.9856080639982053, 0.9856080639982053, 0.9757985669277175, 0.9757985669277175, 0.960408411579618, 0.960408411579618, 0.9388169168598529, 0.9388169168598529, 0.9096243870560463, 0.9096243870560463, 0.8722870850114236, 0.8722870850114236, 0.8251638820370788, 0.8251638820370788, 0.7719255169008213, 0.7719255169008213, 0.7146457142055949, 0.7146457142055949, 0.6526774609321433, 0.6526774609321433, 0.5905166768289659, 0.5905166768289659, 0.5299494871601087, 0.5299494871601087, 0.47226136863771956, 0.47226136863771956, 0.4203614860370692, 0.4203614860370692, 0.36831592291516985, 0.36831592291516985, 0.3133437543922164, 0.3133437543922164, 0.2681739015056048, 0.2681739015056048, 0.2330946475403417, 0.2330946475403417, 0.20420647375510695, 0.20420647375510695, 0.17940214218760847, 0.17940214218760847, 0.1578014141953699, 0.1578014141953699, 0.13895493718467947, 0.13895493718467947, 0.122197231591334, 0.122197231591334, 0.1073118284717874, 0.1073118284717874, 0.09414107824788054, 0.09414107824788054, 0.08278723086293138, 0.08278723086293138, 0.07282418789093932, 0.07282418789093932, 0.06404231984944979, 0.06404231984944979, 0.05636776055867454, 0.05636776055867454, 0.04962131613801622, 0.04962131613801622, 0.043674404718954576, 0.043674404718954576, 0.03833825717536413, 0.03833825717536413, 0.033654594219903036, 0.033654594219903036, 0.029397371663497148, 0.029397371663497148, 0.025497510949122275, 0.025497510949122275, 0.02187772616644444, 0.02187772616644444, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9998416664757317, 0.9998416664757317, 0.999321525459723, 0.999321525459723, 0.9981129926848544, 0.9981129926848544, 0.9955724748624157, 0.9955724748624157, 0.9916992880462977, 0.9916992880462977, 0.9854852956716128, 0.9854852956716128, 0.9757277785054205, 0.9757277785054205, 0.9602661507889148, 0.9602661507889148, 0.938623702084018, 0.938623702084018, 0.9095163235708006, 0.9095163235708006, 0.8722511778406932, 0.8722511778406932, 0.8249340761444043, 0.8249340761444043, 0.7714337596483423, 0.7714337596483423, 0.7140106702432488, 0.7140106702432488, 0.6516529096606362, 0.6516529096606362, 0.5891392093651373, 0.5891392093651373, 0.5282591143513438, 0.5282591143513438, 0.4700942853908769, 0.4700942853908769, 0.4178743160111442, 0.4178743160111442, 0.36429055808976585, 0.36429055808976585, 0.3092571763900435, 0.3092571763900435, 0.2649976557747109, 0.2649976557747109, 0.23013555469910305, 0.23013555469910305, 0.20121660333895652, 0.20121660333895652, 0.1763233587772685, 0.1763233587772685, 0.15490900609977337, 0.15490900609977337, 0.13621162934087772, 0.13621162934087772, 0.11938176743301689, 0.11938176743301689, 0.10455005408303858, 0.10455005408303858, 0.0915321658145268, 0.0915321658145268, 0.08035272468741098, 0.08035272468741098, 0.07037566082018133, 0.07037566082018133, 0.061783587823980995, 0.061783587823980995, 0.054236926455616855, 0.054236926455616855, 0.04759957143936801, 0.04759957143936801, 0.041705665843765505, 0.041705665843765505, 0.036502545818404786, 0.036502545818404786, 0.031839059273163633, 0.031839059273163633, 0.027558240575992054, 0.027558240575992054, 0.02359032722375673, 0.02359032722375673, 0.0]]

#high turnover mass
dictt= {'Z_re': [8.23401510640146, 8.036739240025454, 7.832725722821644, 7.62925343031949, 7.410530751741991, 7.182371759424072, 6.924895431095525, 6.62988797876986, 6.2839108943005115, 5.89755181699601, 5.48411175391887, 5.03311008936852, 4.544029746128345, 4.054363128470839], 'Heff': [8.5, 8.607142857142858, 8.714285714285714, 8.821428571428571, 8.928571428571429, 9.035714285714286, 9.142857142857142, 9.25, 9.357142857142858, 9.464285714285714, 9.571428571428571, 9.678571428571429, 9.785714285714285, 9.892857142857142], 'medians': [array([2.67957484, 0.98607503, 2.67449285, 0.03351739]), array([1.39740164, 1.02094306, 1.03944036, 0.0269524 ]), array([1.12757185, 0.99028645, 0.8610585 , 0.04180708]), array([1.4689044 , 1.03180484, 1.1036107 , 0.0341851 ]), array([1.48434779, 1.07176596, 1.06909846, 0.03675563]), array([1.40125548, 1.22270194, 0.75894785, 0.05197821]), array([1.16938932, 1.4113669 , 0.56415932, 0.04716416]), array([3.26288602, 1.18481508, 1.92758529, 0.07812695]), array([2.13132732, 1.41102185, 1.22230405, 0.07357369]), array([2.7717923 , 1.35422767, 1.50836578, 0.05741202]), array([2.58018654, 1.52014361, 1.09971573, 0.0961823 ]), array([3.31156796, 1.37478154, 1.75602212, 0.10914802]), array([3.41632124, 1.39994978, 1.75499781, 0.10517893]), array([3.24337916, 1.44491372, 1.56906187, 0.08989963])], 'a16': [array([1.06772692]), array([1.0389634]), array([1.04338462]), array([1.07433317]), array([1.1227459]), array([1.12632081]), array([1.26403155]), array([1.5305827]), array([1.82594722]), array([2.11710686]), array([2.34314535]), array([2.49521884]), array([2.59050707]), array([2.6400839])], 'a50': [array([1.45563871]), array([1.43523435]), array([1.51316457]), array([1.51331861]), array([1.6237272]), array([1.68802481]), array([1.74525456]), array([2.06168323]), array([2.32325003]), array([2.55557655]), array([2.73610086]), array([2.87036409]), array([2.94876754]), array([3.00768446])], 'a84': [array([2.13755472]), array([2.18640437]), array([2.32993431]), array([2.34667421]), array([2.54497718]), array([2.60071278]), array([2.60302357]), array([2.89906796]), array([3.04867494]), array([3.15114573]), array([3.2169759]), array([3.28044184]), array([3.31879585]), array([3.34803945])], 'b16': [array([0.98107454]), array([0.9859628]), array([0.99502914]), array([1.01248172]), array([1.04314999]), array([1.09256942]), array([1.15778745]), array([1.20498075]), array([1.26350812]), array([1.3185163]), array([1.36121467]), array([1.38732665]), array([1.40179622]), array([1.40916874])], 'b50': [array([0.99752961]), array([1.00591716]), array([1.0185331]), array([1.0441968]), array([1.09048794]), array([1.16808848]), array([1.26916328]), array([1.31816927]), array([1.36808306]), array([1.41321572]), array([1.4433465]), array([1.45778264]), array([1.4661899]), array([1.46757743])], 'b84': [array([1.02956477]), array([1.04779399]), array([1.06940876]), array([1.10732999]), array([1.18066088]), array([1.32137971]), array([1.44124669]), array([1.48452199]), array([1.50945386]), array([1.53208]), array([1.54631149]), array([1.54644377]), array([1.5503669]), array([1.5512494])], 'k16': [array([0.72316968]), array([0.66513344]), array([0.64130475]), array([0.62551893]), array([0.6123717]), array([0.53587644]), array([0.56379249]), array([0.70320621]), array([0.8720493]), array([0.98778812]), array([1.07327213]), array([1.17626411]), array([1.24679266]), array([1.32320576])], 'k50': [array([1.17033486]), array([1.11701048]), array([1.14467553]), array([1.08762847]), array([1.08666076]), array([1.01761697]), array([0.94672979]), array([1.10293092]), array([1.22509322]), array([1.27969381]), array([1.33067692]), array([1.41228035]), array([1.48021332]), array([1.55971475])], 'k84': [array([1.98516031]), array([1.99254687]), array([2.06128692]), array([1.97063367]), array([1.98929128]), array([1.82703478]), array([1.6421218]), array([1.74579708]), array([1.7363513]), array([1.66982044]), array([1.64470666]), array([1.6899502]), array([1.75357905]), array([1.82487224])], 'p16': [array([0.02432335]), array([0.0262314]), array([0.02899691]), array([0.03271022]), array([0.03820812]), array([0.04637316]), array([0.05347161]), array([0.05811497]), array([0.05838639]), array([0.06392697]), array([0.0714511]), array([0.08352152]), array([0.09272328]), array([0.10062216])], 'p50': [array([0.0286552]), array([0.03114748]), array([0.03446472]), array([0.03858835]), array([0.04507514]), array([0.05477362]), array([0.06340401]), array([0.06832295]), array([0.06865855]), array([0.07560986]), array([0.0851286]), array([0.09806414]), array([0.1086317]), array([0.11742736])], 'p84': [array([0.03464905]), array([0.03774013]), array([0.04154155]), array([0.04655266]), array([0.05442553]), array([0.06588343]), array([0.07682141]), array([0.08202272]), array([0.08213592]), array([0.09072879]), array([0.10236306]), array([0.11744317]), array([0.12781359]), array([0.13519904])], 'width50': [2.05050505050505, 1.9797979797979801, 1.9797979797979792, 1.9797979797979801, 1.7676767676767673, 1.8383838383838382, 1.8383838383838391, 1.7676767676767673, 1.7676767676767682, 1.7676767676767682, 1.7676767676767673, 1.8383838383838382, 1.6262626262626263, 1.4141414141414144], 'width90': [5.656565656565656, 5.656565656565656, 5.373737373737374, 5.373737373737373, 5.373737373737374, 5.585858585858586, 5.444444444444445, 5.444444444444445, 5.232323232323232, 4.949494949494948, 4.737373737373737, 4.525252525252526, 4.313131313131313, 4.1010101010101]}
ion_rates = [[0.9994955897445017, 0.9994955897445017, 0.9994955897445017, 0.9994955897445017, 0.9980155303643005, 0.9980155303643005, 0.9980155303643005, 0.9937788261911691, 0.9937788261911691, 0.9937788261911691, 0.9847661263378413, 0.9847661263378413, 0.9847661263378413, 0.9669113711854188, 0.9669113711854188, 0.9669113711854188, 0.9337964104456353, 0.9337964104456353, 0.9337964104456353, 0.9337964104456353, 0.8905891409192304, 0.8905891409192304, 0.8905891409192304, 0.835721616150977, 0.835721616150977, 0.835721616150977, 0.7709170383628793, 0.7709170383628793, 0.7709170383628793, 0.7042401581009826, 0.7042401581009826, 0.7042401581009826, 0.637449742784967, 0.637449742784967, 0.637449742784967, 0.5739696266372387, 0.5739696266372387, 0.5739696266372387, 0.5739696266372387, 0.5151612043880615, 0.5151612043880615, 0.5151612043880615, 0.4606421501624201, 0.4606421501624201, 0.4606421501624201, 0.40967619597381444, 0.40967619597381444, 0.40967619597381444, 0.36318119750072414, 0.36318119750072414, 0.36318119750072414, 0.3222918213382295, 0.3222918213382295, 0.3222918213382295, 0.27729227103279624, 0.27729227103279624, 0.27729227103279624, 0.27729227103279624, 0.22262172274397812, 0.22262172274397812, 0.22262172274397812, 0.19278320584007905, 0.19278320584007905, 0.19278320584007905, 0.1701890461242997, 0.1701890461242997, 0.1701890461242997, 0.15030878456962862, 0.15030878456962862, 0.15030878456962862, 0.13293450155888417, 0.13293450155888417, 0.13293450155888417, 0.13293450155888417, 0.11749783787536244, 0.11749783787536244, 0.11749783787536244, 0.10378335049468113, 0.10378335049468113, 0.10378335049468113, 0.09186114389302809, 0.09186114389302809, 0.09186114389302809, 0.08116388477286321, 0.08116388477286321, 0.08116388477286321, 0.07174081725404528, 0.07174081725404528, 0.07174081725404528, 0.06342505848594165, 0.06342505848594165, 0.06342505848594165, 0.06342505848594165, 0.05601826409689875, 0.05601826409689875, 0.05601826409689875, 0.04965209371292798, 0.04965209371292798, 0.04965209371292798, 0.04397260522254409], [0.998589019176823, 0.998589019176823, 0.998589019176823, 0.998589019176823, 0.9951993822598743, 0.9951993822598743, 0.9951993822598743, 0.9874625838731663, 0.9874625838731663, 0.9874625838731663, 0.9722054560432966, 0.9722054560432966, 0.9722054560432966, 0.942112169213739, 0.942112169213739, 0.942112169213739, 0.9005309815618389, 0.9005309815618389, 0.9005309815618389, 0.9005309815618389, 0.8479950290796787, 0.8479950290796787, 0.8479950290796787, 0.7843442683777174, 0.7843442683777174, 0.7843442683777174, 0.7172624920192039, 0.7172624920192039, 0.7172624920192039, 0.6496342427194791, 0.6496342427194791, 0.6496342427194791, 0.5850061230275422, 0.5850061230275422, 0.5850061230275422, 0.52453947343673, 0.52453947343673, 0.52453947343673, 0.52453947343673, 0.46881462222065673, 0.46881462222065673, 0.46881462222065673, 0.4167553801765744, 0.4167553801765744, 0.4167553801765744, 0.3686684971344368, 0.3686684971344368, 0.3686684971344368, 0.32576250586911254, 0.32576250586911254, 0.32576250586911254, 0.27278369828127763, 0.27278369828127763, 0.27278369828127763, 0.22284537312167024, 0.22284537312167024, 0.22284537312167024, 0.22284537312167024, 0.19481555170341908, 0.19481555170341908, 0.19481555170341908, 0.17193242475652373, 0.17193242475652373, 0.17193242475652373, 0.1517495170485537, 0.1517495170485537, 0.1517495170485537, 0.13412046411215076, 0.13412046411215076, 0.13412046411215076, 0.11848579803003002, 0.11848579803003002, 0.11848579803003002, 0.11848579803003002, 0.1046639311102121, 0.1046639311102121, 0.1046639311102121, 0.0924910582595555, 0.0924910582595555, 0.0924910582595555, 0.08186390361557852, 0.08186390361557852, 0.08186390361557852, 0.07231635790489524, 0.07231635790489524, 0.07231635790489524, 0.06392946874143998, 0.06392946874143998, 0.06392946874143998, 0.056523016325451654, 0.056523016325451654, 0.056523016325451654, 0.056523016325451654, 0.04993593134822535, 0.04993593134822535, 0.04993593134822535, 0.044288588324971526, 0.044288588324971526, 0.044288588324971526, 0.03911898165895916], [0.9964660504540205, 0.9964660504540205, 0.9964660504540205, 0.9964660504540205, 0.9899141887014155, 0.9899141887014155, 0.9899141887014155, 0.9767143707678697, 0.9767143707678697, 0.9767143707678697, 0.9502760919456112, 0.9502760919456112, 0.9502760919456112, 0.9103613389886557, 0.9103613389886557, 0.9103613389886557, 0.8601032690230206, 0.8601032690230206, 0.8601032690230206, 0.8601032690230206, 0.797857333629254, 0.797857333629254, 0.797857333629254, 0.7304212731862005, 0.7304212731862005, 0.7304212731862005, 0.6625143158469972, 0.6625143158469972, 0.6625143158469972, 0.5961551285528008, 0.5961551285528008, 0.5961551285528008, 0.5342542439711006, 0.5342542439711006, 0.5342542439711006, 0.47685372478760907, 0.47685372478760907, 0.47685372478760907, 0.47685372478760907, 0.42370632448386863, 0.42370632448386863, 0.42370632448386863, 0.37415408690287655, 0.37415408690287655, 0.37415408690287655, 0.32783007495707384, 0.32783007495707384, 0.32783007495707384, 0.26749474301921855, 0.26749474301921855, 0.26749474301921855, 0.2243606557264927, 0.2243606557264927, 0.2243606557264927, 0.19660543867106536, 0.19660543867106536, 0.19660543867106536, 0.19660543867106536, 0.1732599641543844, 0.1732599641543844, 0.1732599641543844, 0.15269165281390817, 0.15269165281390817, 0.15269165281390817, 0.13470660592769254, 0.13470660592769254, 0.13470660592769254, 0.11897823922861822, 0.11897823922861822, 0.11897823922861822, 0.10499940667675031, 0.10499940667675031, 0.10499940667675031, 0.10499940667675031, 0.09259296622981888, 0.09259296622981888, 0.09259296622981888, 0.08179277322022689, 0.08179277322022689, 0.08179277322022689, 0.07224420159037989, 0.07224420159037989, 0.07224420159037989, 0.06374993288778803, 0.06374993288778803, 0.06374993288778803, 0.056187198785858865, 0.056187198785858865, 0.056187198785858865, 0.049551553634882894, 0.049551553634882894, 0.049551553634882894, 0.049551553634882894, 0.043628922302696084, 0.043628922302696084, 0.043628922302696084, 0.03845623787919255, 0.03845623787919255, 0.03845623787919255, 0.03366040776183082], [0.9921383814483722, 0.9921383814483722, 0.9921383814483722, 0.9921383814483722, 0.9807804303867681, 0.9807804303867681, 0.9807804303867681, 0.9581086427876002, 0.9581086427876002, 0.9581086427876002, 0.9201759656549622, 0.9201759656549622, 0.9201759656549622, 0.8720278694360557, 0.8720278694360557, 0.8720278694360557, 0.8117783727348987, 0.8117783727348987, 0.8117783727348987, 0.8117783727348987, 0.7440601845218208, 0.7440601845218208, 0.7440601845218208, 0.6758392959185174, 0.6758392959185174, 0.6758392959185174, 0.6081344446545679, 0.6081344446545679, 0.6081344446545679, 0.5446351780157834, 0.5446351780157834, 0.5446351780157834, 0.48569578008670383, 0.48569578008670383, 0.48569578008670383, 0.43115860128917, 0.43115860128917, 0.43115860128917, 0.43115860128917, 0.3803318301337764, 0.3803318301337764, 0.3803318301337764, 0.3285400110183718, 0.3285400110183718, 0.3285400110183718, 0.26522267404462135, 0.26522267404462135, 0.26522267404462135, 0.22752356450825814, 0.22752356450825814, 0.22752356450825814, 0.19923452751463902, 0.19923452751463902, 0.19923452751463902, 0.17517125155640487, 0.17517125155640487, 0.17517125155640487, 0.17517125155640487, 0.1542910607901561, 0.1542910607901561, 0.1542910607901561, 0.13601841456504277, 0.13601841456504277, 0.13601841456504277, 0.12004964080860213, 0.12004964080860213, 0.12004964080860213, 0.10598736683141788, 0.10598736683141788, 0.10598736683141788, 0.09346362962676719, 0.09346362962676719, 0.09346362962676719, 0.09346362962676719, 0.08246406632635789, 0.08246406632635789, 0.08246406632635789, 0.07289531828629095, 0.07289531828629095, 0.07289531828629095, 0.06435077954467655, 0.06435077954467655, 0.06435077954467655, 0.05669639666412125, 0.05669639666412125, 0.05669639666412125, 0.049959185515936456, 0.049959185515936456, 0.049959185515936456, 0.04396132011174311, 0.04396132011174311, 0.04396132011174311, 0.04396132011174311, 0.038634747813680766, 0.038634747813680766, 0.038634747813680766, 0.03385943607959355, 0.03385943607959355, 0.03385943607959355, 0.02941891596593538], [0.984466215968979, 0.984466215968979, 0.984466215968979, 0.984466215968979, 0.965319144643317, 0.965319144643317, 0.965319144643317, 0.929987856536832, 0.929987856536832, 0.929987856536832, 0.8837103529264515, 0.8837103529264515, 0.8837103529264515, 0.8258717662600493, 0.8258717662600493, 0.8258717662600493, 0.7583030202718207, 0.7583030202718207, 0.7583030202718207, 0.7583030202718207, 0.6893786930952562, 0.6893786930952562, 0.6893786930952562, 0.6205901292213581, 0.6205901292213581, 0.6205901292213581, 0.5553519296000591, 0.5553519296000591, 0.5553519296000591, 0.4948274865630238, 0.4948274865630238, 0.4948274865630238, 0.4387445895588103, 0.4387445895588103, 0.4387445895588103, 0.38611254264831457, 0.38611254264831457, 0.38611254264831457, 0.38611254264831457, 0.32649432820590335, 0.32649432820590335, 0.32649432820590335, 0.26605845619000296, 0.26605845619000296, 0.26605845619000296, 0.23060474172998013, 0.23060474172998013, 0.23060474172998013, 0.20163415243859276, 0.20163415243859276, 0.20163415243859276, 0.17679186186203644, 0.17679186186203644, 0.17679186186203644, 0.15543940630741943, 0.15543940630741943, 0.15543940630741943, 0.15543940630741943, 0.13677725277314498, 0.13677725277314498, 0.13677725277314498, 0.12048086883042138, 0.12048086883042138, 0.12048086883042138, 0.10626881065533322, 0.10626881065533322, 0.10626881065533322, 0.09370369471107894, 0.09370369471107894, 0.09370369471107894, 0.08255058550916539, 0.08255058550916539, 0.08255058550916539, 0.08255058550916539, 0.07273390700453149, 0.07273390700453149, 0.07273390700453149, 0.06410455894538246, 0.06410455894538246, 0.06410455894538246, 0.05636434082812879, 0.05636434082812879, 0.05636434082812879, 0.049483500997022443, 0.049483500997022443, 0.049483500997022443, 0.043297550412812774, 0.043297550412812774, 0.043297550412812774, 0.037807173021608936, 0.037807173021608936, 0.037807173021608936, 0.037807173021608936, 0.032860874760234145, 0.032860874760234145, 0.032860874760234145, 0.02837008460755343, 0.02837008460755343, 0.02837008460755343, 0.019061236088963606], [0.9714223377483194, 0.9714223377483194, 0.9714223377483194, 0.9714223377483194, 0.9397525551371705, 0.9397525551371705, 0.9397525551371705, 0.8953011876382212, 0.8953011876382212, 0.8953011876382212, 0.8399121539617408, 0.8399121539617408, 0.8399121539617408, 0.7732462168375905, 0.7732462168375905, 0.7732462168375905, 0.7035685230217971, 0.7035685230217971, 0.7035685230217971, 0.7035685230217971, 0.6338029421309778, 0.6338029421309778, 0.6338029421309778, 0.5669030954374981, 0.5669030954374981, 0.5669030954374981, 0.5045405472321214, 0.5045405472321214, 0.5045405472321214, 0.4468267807306391, 0.4468267807306391, 0.4468267807306391, 0.3920861279656331, 0.3920861279656331, 0.3920861279656331, 0.32368809732005976, 0.32368809732005976, 0.32368809732005976, 0.32368809732005976, 0.2703714203543046, 0.2703714203543046, 0.2703714203543046, 0.23477441918441477, 0.23477441918441477, 0.23477441918441477, 0.2048138179000324, 0.2048138179000324, 0.2048138179000324, 0.17929202686403528, 0.17929202686403528, 0.17929202686403528, 0.15747004230548658, 0.15747004230548658, 0.15747004230548658, 0.13847891069271087, 0.13847891069271087, 0.13847891069271087, 0.13847891069271087, 0.12185286472537683, 0.12185286472537683, 0.12185286472537683, 0.10756830826271875, 0.10756830826271875, 0.10756830826271875, 0.09480792570430205, 0.09480792570430205, 0.09480792570430205, 0.08356898126569015, 0.08356898126569015, 0.08356898126569015, 0.073585077937369, 0.073585077937369, 0.073585077937369, 0.073585077937369, 0.06479124083896934, 0.06479124083896934, 0.06479124083896934, 0.05698741573356469, 0.05698741573356469, 0.05698741573356469, 0.05002381842325116, 0.05002381842325116, 0.05002381842325116, 0.04382624075518594, 0.04382624075518594, 0.04382624075518594, 0.03817855575887753, 0.03817855575887753, 0.03817855575887753, 0.033128639661966476, 0.033128639661966476, 0.033128639661966476, 0.033128639661966476, 0.02848840728443643, 0.02848840728443643, 0.02848840728443643, 0.018642661070163637, 0.018642661070163637, 0.018642661070163637, 0.014077320791585548], [0.9492173433686466, 0.9492173433686466, 0.9492173433686466, 0.9492173433686466, 0.9068588509636971, 0.9068588509636971, 0.9068588509636971, 0.853842426339859, 0.853842426339859, 0.853842426339859, 0.788684590386385, 0.788684590386385, 0.788684590386385, 0.7180811755118567, 0.7180811755118567, 0.7180811755118567, 0.6477574945959708, 0.6477574945959708, 0.6477574945959708, 0.6477574945959708, 0.5789196866022138, 0.5789196866022138, 0.5789196866022138, 0.5146636335936546, 0.5146636335936546, 0.5146636335936546, 0.4550977410285934, 0.4550977410285934, 0.4550977410285934, 0.3962923965369073, 0.3962923965369073, 0.3962923965369073, 0.3231310232141569, 0.3231310232141569, 0.3231310232141569, 0.27532763583426206, 0.27532763583426206, 0.27532763583426206, 0.27532763583426206, 0.23880320374036448, 0.23880320374036448, 0.23880320374036448, 0.20779924266647334, 0.20779924266647334, 0.20779924266647334, 0.18138695379636258, 0.18138695379636258, 0.18138695379636258, 0.1590325171918404, 0.1590325171918404, 0.1590325171918404, 0.13956570106015068, 0.13956570106015068, 0.13956570106015068, 0.12270642946959637, 0.12270642946959637, 0.12270642946959637, 0.12270642946959637, 0.10798688328151872, 0.10798688328151872, 0.10798688328151872, 0.09512596064505693, 0.09512596064505693, 0.09512596064505693, 0.08374133568519602, 0.08374133568519602, 0.08374133568519602, 0.0735768705840592, 0.0735768705840592, 0.0735768705840592, 0.06469035878786966, 0.06469035878786966, 0.06469035878786966, 0.06469035878786966, 0.0567162311012866, 0.0567162311012866, 0.0567162311012866, 0.04968150339562145, 0.04968150339562145, 0.04968150339562145, 0.04327121848761049, 0.04327121848761049, 0.04327121848761049, 0.037553087042059605, 0.037553087042059605, 0.037553087042059605, 0.03225558245363615, 0.03225558245363615, 0.03225558245363615, 0.02217182299337906, 0.02217182299337906, 0.02217182299337906, 0.02217182299337906, 0.01859102313892279, 0.01859102313892279, 0.01859102313892279, 0.01374800074002969, 0.01374800074002969, 0.01374800074002969, 0.01011316914295055], [0.918308792776982, 0.918308792776982, 0.918308792776982, 0.918308792776982, 0.8674775759718789, 0.8674775759718789, 0.8674775759718789, 0.8044936627263392, 0.8044936627263392, 0.8044936627263392, 0.733436107635335, 0.733436107635335, 0.733436107635335, 0.6621395133791828, 0.6621395133791828, 0.6621395133791828, 0.5916756235109211, 0.5916756235109211, 0.5916756235109211, 0.5916756235109211, 0.5255500038129995, 0.5255500038129995, 0.5255500038129995, 0.46379172199505714, 0.46379172199505714, 0.46379172199505714, 0.3976284852611323, 0.3976284852611323, 0.3976284852611323, 0.3279559210411575, 0.3279559210411575, 0.3279559210411575, 0.2815440220203289, 0.2815440220203289, 0.2815440220203289, 0.24368760487886118, 0.24368760487886118, 0.24368760487886118, 0.24368760487886118, 0.2115462414254531, 0.2115462414254531, 0.2115462414254531, 0.18428414951472313, 0.18428414951472313, 0.18428414951472313, 0.16131245154669283, 0.16131245154669283, 0.16131245154669283, 0.14144073931838616, 0.14144073931838616, 0.14144073931838616, 0.12423949467325672, 0.12423949467325672, 0.12423949467325672, 0.10923029730795392, 0.10923029730795392, 0.10923029730795392, 0.10923029730795392, 0.09610468752725097, 0.09610468752725097, 0.09610468752725097, 0.08461747065101752, 0.08461747065101752, 0.08461747065101752, 0.07442188600191436, 0.07442188600191436, 0.07442188600191436, 0.06534113351072615, 0.06534113351072615, 0.06534113351072615, 0.05721824754540291, 0.05721824754540291, 0.05721824754540291, 0.05721824754540291, 0.05000774568968613, 0.05000774568968613, 0.05000774568968613, 0.043528040251596414, 0.043528040251596414, 0.043528040251596414, 0.03765294317399555, 0.03765294317399555, 0.03765294317399555, 0.03229148962436654, 0.03229148962436654, 0.03229148962436654, 0.021276195563446773, 0.021276195563446773, 0.021276195563446773, 0.016026225229609257, 0.016026225229609257, 0.016026225229609257, 0.016026225229609257, 0.012061731607919686, 0.012061731607919686, 0.012061731607919686, 0.009880627465839457, 0.009880627465839457, 0.009880627465839457, 0.007063453442249471], [0.8810313360169099, 0.8810313360169099, 0.8810313360169099, 0.8810313360169099, 0.8204514933450334, 0.8204514933450334, 0.8204514933450334, 0.7496124590359027, 0.7496124590359027, 0.7496124590359027, 0.6772099239212546, 0.6772099239212546, 0.6772099239212546, 0.6053394988795253, 0.6053394988795253, 0.6053394988795253, 0.537153149554734, 0.537153149554734, 0.537153149554734, 0.537153149554734, 0.472945998692979, 0.472945998692979, 0.472945998692979, 0.3976674701893539, 0.3976674701893539, 0.3976674701893539, 0.33602067158720295, 0.33602067158720295, 0.33602067158720295, 0.28897372860402837, 0.28897372860402837, 0.28897372860402837, 0.2493691452075725, 0.2493691452075725, 0.2493691452075725, 0.2158793819999747, 0.2158793819999747, 0.2158793819999747, 0.2158793819999747, 0.18784614085117776, 0.18784614085117776, 0.18784614085117776, 0.16417715982486875, 0.16417715982486875, 0.16417715982486875, 0.14386430235616016, 0.14386430235616016, 0.14386430235616016, 0.12636280536911373, 0.12636280536911373, 0.12636280536911373, 0.11102462992530966, 0.11102462992530966, 0.11102462992530966, 0.097647669949494, 0.097647669949494, 0.097647669949494, 0.097647669949494, 0.08588482279127299, 0.08588482279127299, 0.08588482279127299, 0.07552269726459174, 0.07552269726459174, 0.07552269726459174, 0.066394068545763, 0.066394068545763, 0.066394068545763, 0.05818842510123257, 0.05818842510123257, 0.05818842510123257, 0.05077034560138868, 0.05077034560138868, 0.05077034560138868, 0.05077034560138868, 0.04415248304925062, 0.04415248304925062, 0.04415248304925062, 0.03816077316003963, 0.03816077316003963, 0.03816077316003963, 0.03267210563410867, 0.03267210563410867, 0.03267210563410867, 0.021218402117223575, 0.021218402117223575, 0.021218402117223575, 0.015763589923695552, 0.015763589923695552, 0.015763589923695552, 0.01159083471176972, 0.01159083471176972, 0.01159083471176972, 0.01159083471176972, 0.008495294621755573, 0.008495294621755573, 0.008495294621755573, 0.006889047184416151, 0.006889047184416151, 0.006889047184416151, 0.00493740696195584], [0.8364383916733665, 0.8364383916733665, 0.8364383916733665, 0.8364383916733665, 0.7665709028122838, 0.7665709028122838, 0.7665709028122838, 0.6928993056921073, 0.6928993056921073, 0.6928993056921073, 0.6197051029561177, 0.6197051029561177, 0.6197051029561177, 0.5491331496026102, 0.5491331496026102, 0.5491331496026102, 0.4803798089533333, 0.4803798089533333, 0.4803798089533333, 0.4803798089533333, 0.4011709841334762, 0.4011709841334762, 0.4011709841334762, 0.3448575972904791, 0.3448575972904791, 0.3448575972904791, 0.29629810748691865, 0.29629810748691865, 0.29629810748691865, 0.25491184447612636, 0.25491184447612636, 0.25491184447612636, 0.22004119407415412, 0.22004119407415412, 0.22004119407415412, 0.19086542095002165, 0.19086542095002165, 0.19086542095002165, 0.19086542095002165, 0.16629192119436143, 0.16629192119436143, 0.16629192119436143, 0.14543601051498747, 0.14543601051498747, 0.14543601051498747, 0.12748105725757444, 0.12748105725757444, 0.12748105725757444, 0.11192709681633345, 0.11192709681633345, 0.11192709681633345, 0.09819893051346912, 0.09819893051346912, 0.09819893051346912, 0.08613001747140336, 0.08613001747140336, 0.08613001747140336, 0.08613001747140336, 0.07551414793822736, 0.07551414793822736, 0.07551414793822736, 0.06612151602126662, 0.06612151602126662, 0.06612151602126662, 0.057727445423665286, 0.057727445423665286, 0.057727445423665286, 0.05015205831871684, 0.05015205831871684, 0.05015205831871684, 0.04334371677518042, 0.04334371677518042, 0.04334371677518042, 0.04334371677518042, 0.037091423418383174, 0.037091423418383174, 0.037091423418383174, 0.024977027960058917, 0.024977027960058917, 0.024977027960058917, 0.01907286317281916, 0.01907286317281916, 0.01907286317281916, 0.015785818172242935, 0.015785818172242935, 0.015785818172242935, 0.01140514334313542, 0.01140514334313542, 0.01140514334313542, 0.008118440315613772, 0.008118440315613772, 0.008118440315613772, 0.008118440315613772, 0.00585594658654466, 0.00585594658654466, 0.00585594658654466, 0.004679901251860761, 0.004679901251860761, 0.004679901251860761, 0.003315086791051386], [0.7840115285956158, 0.7840115285956158, 0.7840115285956158, 0.7840115285956158, 0.7092610064882547, 0.7092610064882547, 0.7092610064882547, 0.6348996497170002, 0.6348996497170002, 0.6348996497170002, 0.561843604095059, 0.561843604095059, 0.561843604095059, 0.4849742169415503, 0.4849742169415503, 0.4849742169415503, 0.41057592708040164, 0.41057592708040164, 0.41057592708040164, 0.41057592708040164, 0.3548767238434215, 0.3548767238434215, 0.3548767238434215, 0.3047773293751092, 0.3047773293751092, 0.3047773293751092, 0.2615037170761167, 0.2615037170761167, 0.2615037170761167, 0.22542863757593085, 0.22542863757593085, 0.22542863757593085, 0.19494413357193932, 0.19494413357193932, 0.19494413357193932, 0.16955981570388143, 0.16955981570388143, 0.16955981570388143, 0.16955981570388143, 0.14812836437365753, 0.14812836437365753, 0.14812836437365753, 0.1297418411213707, 0.1297418411213707, 0.1297418411213707, 0.1138534310327552, 0.1138534310327552, 0.1138534310327552, 0.09993170798100134, 0.09993170798100134, 0.09993170798100134, 0.08759776582163985, 0.08759776582163985, 0.08759776582163985, 0.07677295075211844, 0.07677295075211844, 0.07677295075211844, 0.07677295075211844, 0.06711597366397112, 0.06711597366397112, 0.06711597366397112, 0.058572118868465875, 0.058572118868465875, 0.058572118868465875, 0.05083703034703083, 0.05083703034703083, 0.05083703034703083, 0.043812219859948355, 0.043812219859948355, 0.043812219859948355, 0.03745870247899687, 0.03745870247899687, 0.03745870247899687, 0.03745870247899687, 0.024693532297816127, 0.024693532297816127, 0.024693532297816127, 0.018337621105482614, 0.018337621105482614, 0.018337621105482614, 0.013453561940040496, 0.013453561940040496, 0.013453561940040496, 0.009846430160381944, 0.009846430160381944, 0.009846430160381944, 0.00798062517461999, 0.00798062517461999, 0.00798062517461999, 0.005603912445322783, 0.005603912445322783, 0.005603912445322783, 0.005603912445322783, 0.003977488597763428, 0.003977488597763428, 0.003977488597763428, 0.003163250754820025, 0.003163250754820025, 0.003163250754820025, 0.0022149594744831675], [0.726572708430012, 0.726572708430012, 0.726572708430012, 0.726572708430012, 0.6507436033085209, 0.6507436033085209, 0.6507436033085209, 0.5752058592295278, 0.5752058592295278, 0.5752058592295278, 0.48989178946634077, 0.48989178946634077, 0.48989178946634077, 0.42246769808019746, 0.42246769808019746, 0.42246769808019746, 0.36573265846090924, 0.36573265846090924, 0.36573265846090924, 0.36573265846090924, 0.31427973464258857, 0.31427973464258857, 0.31427973464258857, 0.2689977145940763, 0.2689977145940763, 0.2689977145940763, 0.2313755489949925, 0.2313755489949925, 0.2313755489949925, 0.19982408906072655, 0.19982408906072655, 0.19982408906072655, 0.17330955024729783, 0.17330955024729783, 0.17330955024729783, 0.1512180909217439, 0.1512180909217439, 0.1512180909217439, 0.1512180909217439, 0.1323056131115205, 0.1323056131115205, 0.1323056131115205, 0.11614396655229947, 0.11614396655229947, 0.11614396655229947, 0.10193532810775707, 0.10193532810775707, 0.10193532810775707, 0.08946186094212892, 0.08946186094212892, 0.08946186094212892, 0.0783333738001448, 0.0783333738001448, 0.0783333738001448, 0.06854473708598605, 0.06854473708598605, 0.06854473708598605, 0.06854473708598605, 0.05977073442475173, 0.05977073442475173, 0.05977073442475173, 0.05190535416952357, 0.05190535416952357, 0.05190535416952357, 0.044689038771879006, 0.044689038771879006, 0.044689038771879006, 0.038119394420436034, 0.038119394420436034, 0.038119394420436034, 0.025021484457153683, 0.025021484457153683, 0.025021484457153683, 0.025021484457153683, 0.01846312521651169, 0.01846312521651169, 0.01846312521651169, 0.013376959975815665, 0.013376959975815665, 0.013376959975815665, 0.009493171995005826, 0.009493171995005826, 0.009493171995005826, 0.006797056432735439, 0.006797056432735439, 0.006797056432735439, 0.005441817217454168, 0.005441817217454168, 0.005441817217454168, 0.003838989510660497, 0.003838989510660497, 0.003838989510660497, 0.003838989510660497, 0.0030490317545919287, 0.0030490317545919287, 0.0030490317545919287, 0.002092875093999843, 0.002092875093999843, 0.002092875093999843, 0.0016069313834485726], [0.6671637814970007, 0.6671637814970007, 0.6671637814970007, 0.6671637814970007, 0.5866325468751015, 0.5866325468751015, 0.5866325468751015, 0.5010585775904374, 0.5010585775904374, 0.5010585775904374, 0.43506051384187233, 0.43506051384187233, 0.43506051384187233, 0.37633006144913816, 0.37633006144913816, 0.37633006144913816, 0.32349556649033395, 0.32349556649033395, 0.32349556649033395, 0.32349556649033395, 0.2763463735638414, 0.2763463735638414, 0.2763463735638414, 0.2369189322096555, 0.2369189322096555, 0.2369189322096555, 0.20396469880552232, 0.20396469880552232, 0.20396469880552232, 0.1764676714062992, 0.1764676714062992, 0.1764676714062992, 0.1532952352552333, 0.1532952352552333, 0.1532952352552333, 0.13370907052749686, 0.13370907052749686, 0.13370907052749686, 0.13370907052749686, 0.11703446438641314, 0.11703446438641314, 0.11703446438641314, 0.10240519908474331, 0.10240519908474331, 0.10240519908474331, 0.08958736505315801, 0.08958736505315801, 0.08958736505315801, 0.0782300979376631, 0.0782300979376631, 0.0782300979376631, 0.06808546727369164, 0.06808546727369164, 0.06808546727369164, 0.05905361692930767, 0.05905361692930767, 0.05905361692930767, 0.05905361692930767, 0.0508732794908158, 0.0508732794908158, 0.0508732794908158, 0.04333824520630721, 0.04333824520630721, 0.04333824520630721, 0.02905232085143083, 0.02905232085143083, 0.02905232085143083, 0.021909529660519927, 0.021909529660519927, 0.021909529660519927, 0.016435225002881124, 0.016435225002881124, 0.016435225002881124, 0.016435225002881124, 0.013468266781387227, 0.013468266781387227, 0.013468266781387227, 0.00944426984820158, 0.00944426984820158, 0.00944426984820158, 0.006537840857367485, 0.006537840857367485, 0.006537840857367485, 0.004632025024220242, 0.004632025024220242, 0.004632025024220242, 0.0036618474683905756, 0.0036618474683905756, 0.0036618474683905756, 0.0025398338763295484, 0.0025398338763295484, 0.0025398338763295484, 0.0025398338763295484, 0.0019670290099161928, 0.0019670290099161928, 0.0019670290099161928, 0.00130325931098585, 0.00130325931098585, 0.00130325931098585, 0.0009821466127397957], [0.5960610859627926, 0.5960610859627926, 0.5960610859627926, 0.5960610859627926, 0.5170923262272472, 0.5170923262272472, 0.5170923262272472, 0.4488888782497272, 0.4488888782497272, 0.4488888782497272, 0.3885070379764497, 0.3885070379764497, 0.3885070379764497, 0.3341579443589322, 0.3341579443589322, 0.3341579443589322, 0.28561657912726424, 0.28561657912726424, 0.28561657912726424, 0.28561657912726424, 0.24397007462194023, 0.24397007462194023, 0.24397007462194023, 0.209861682158616, 0.209861682158616, 0.209861682158616, 0.18103061787349528, 0.18103061787349528, 0.18103061787349528, 0.1570518092597412, 0.1570518092597412, 0.1570518092597412, 0.13690207293806492, 0.13690207293806492, 0.13690207293806492, 0.11953257755008452, 0.11953257755008452, 0.11953257755008452, 0.11953257755008452, 0.10462186842449936, 0.10462186842449936, 0.10462186842449936, 0.09148394761383172, 0.09148394761383172, 0.09148394761383172, 0.07986883281518715, 0.07986883281518715, 0.07986883281518715, 0.06955937113891048, 0.06955937113891048, 0.06955937113891048, 0.060224532668172945, 0.060224532668172945, 0.060224532668172945, 0.05181575722922488, 0.05181575722922488, 0.05181575722922488, 0.05181575722922488, 0.04412136350128428, 0.04412136350128428, 0.04412136350128428, 0.02939908152877002, 0.02939908152877002, 0.02939908152877002, 0.02186028554066111, 0.02186028554066111, 0.02186028554066111, 0.015939706046801748, 0.015939706046801748, 0.015939706046801748, 0.011456781274376267, 0.011456781274376267, 0.011456781274376267, 0.011456781274376267, 0.008164606677981415, 0.008164606677981415, 0.008164606677981415, 0.006493726333327292, 0.006493726333327292, 0.006493726333327292, 0.004527039296465674, 0.004527039296465674, 0.004527039296465674, 0.003627650162933062, 0.003627650162933062, 0.003627650162933062, 0.0024399777443936082, 0.0024399777443936082, 0.0024399777443936082, 0.0019027380756560667, 0.0019027380756560667, 0.0019027380756560667, 0.0019027380756560667, 0.001250253487526704, 0.001250253487526704, 0.001250253487526704, 0.0009144359479339185, 0.0009144359479339185, 0.0009144359479339185, 0.0005840899772143354]]

#varying Fstar10 and Fesc
ion_rates = [[0.9739642234629765, 0.9739642234629765, 0.9739642234629765, 0.9523443449796817, 0.9523443449796817, 0.9203319053678485, 0.9203319053678485, 0.8760563120189507, 0.8760563120189507, 0.8203680519197171, 0.8203680519197171, 0.7586641438174521, 0.7586641438174521, 0.6921230268582217, 0.6921230268582217, 0.6256496205637972, 0.6256496205637972, 0.561548139375906, 0.561548139375906, 0.5025759120335872, 0.5025759120335872, 0.4501257947881255, 0.4501257947881255, 0.40300874732876296, 0.40300874732876296, 0.3543794950220692, 0.3543794950220692, 0.29388856534438224, 0.29388856534438224, 0.2567249856114837, 0.2567249856114837, 0.22816408003947736, 0.22816408003947736, 0.20342951097511222, 0.20342951097511222, 0.18104053509207796, 0.18104053509207796, 0.1612303780135948, 0.1612303780135948, 0.1437258032690572, 0.1437258032690572, 0.12802513638740348, 0.12802513638740348, 0.11419608803343949, 0.11419608803343949, 0.10191002210171851, 0.10191002210171851, 0.09100039771466246, 0.09100039771466246, 0.08120321167413935, 0.08120321167413935, 0.07236594399780864, 0.07236594399780864, 0.06446397262574093, 0.06446397262574093, 0.05740975245596498, 0.05740975245596498, 0.05103434879952069, 0.05103434879952069, 0.0452915952940404, 0.0452915952940404, 0.03992261833721074, 0.03992261833721074, 0.035061129393370576, 0.035061129393370576, 0.030544349288542157, 0.030544349288542157, 0.021438632764369966, 0.021438632764369966, 0.018157059332666942, 0.018157059332666942, 0.013768861096358774, 0.013768861096358774, 0.010568677251644634, 0.010568677251644634, 0.008845133056585939, 0.008845133056585939, 0.006541260587913236, 0.006541260587913236, 0.005432241971926064, 0.005432241971926064, 0.0039145655557216025, 0.0039145655557216025, 0.0031950542488955124, 0.0031950542488955124, 0.002356536319077275, 0.002356536319077275, 0.0019482204919145602, 0.0019482204919145602, 0.0015905166768289659, 0.0015905166768289659, 0.0011387702717352089, 0.0011387702717352089, 0.0009164877862613693, 0.0009164877862613693, 0.0006374377737280569, 0.0006374377737280569, 0.0005027003902254526, 0.0005027003902254526, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999603311256693, 0.9999603311256693, 0.9995533831907248, 0.9995533831907248, 0.9984029858351341, 0.9984029858351341, 0.9953303579397765, 0.9953303579397765, 0.9900376409741171, 0.9900376409741171, 0.9807804303867681, 0.9807804303867681, 0.9642361159794776, 0.9642361159794776, 0.9391978748426496, 0.9391978748426496, 0.9032872843817145, 0.9032872843817145, 0.8548450913358733, 0.8548450913358733, 0.7949502206923108, 0.7949502206923108, 0.7289193275305066, 0.7289193275305066, 0.657036249485758, 0.657036249485758, 0.5851121346744604, 0.5851121346744604, 0.515429653235903, 0.515429653235903, 0.4511732582542891, 0.4511732582542891, 0.38729269165965335, 0.38729269165965335, 0.3222035922901491, 0.3222035922901491, 0.27585119658081664, 0.27585119658081664, 0.2374147931387894, 0.2374147931387894, 0.20560411762915554, 0.20560411762915554, 0.1786385163567422, 0.1786385163567422, 0.15553276495131843, 0.15553276495131843, 0.13550511301012547, 0.13550511301012547, 0.11816571125094769, 0.11816571125094769, 0.10312983998738803, 0.10312983998738803, 0.090324658958822, 0.090324658958822, 0.07920232733182021, 0.07920232733182021, 0.06963152745342584, 0.06963152745342584, 0.061362618993799, 0.061362618993799, 0.0541015051260051, 0.0541015051260051, 0.04769156219104872, 0.04769156219104872, 0.04186228950276092, 0.04186228950276092, 0.03690299626531227, 0.03690299626531227, 0.032494963591838746, 0.032494963591838746, 0.02858415973971747, 0.02858415973971747, 0.02499070688224192, 0.02499070688224192, 0.021730335779922557, 0.021730335779922557, 0.014930885535805091, 0.014930885535805091, 0.012542887695706904, 0.012542887695706904, 0.009403575054707139, 0.009403575054707139, 0.007039173355374637, 0.007039173355374637, 0.0057742150265012015, 0.0057742150265012015, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9998707341853706, 0.9998707341853706, 0.9992011509445125, 0.9992011509445125, 0.9975391618992773, 0.9975391618992773, 0.9940414614970828, 0.9940414614970828, 0.9883021277221483, 0.9883021277221483, 0.9785336674182095, 0.9785336674182095, 0.961159384407465, 0.961159384407465, 0.935048373798435, 0.935048373798435, 0.8979894378202364, 0.8979894378202364, 0.8481554144422744, 0.8481554144422744, 0.7846520441268351, 0.7846520441268351, 0.7149551998199853, 0.7149551998199853, 0.6384705323528738, 0.6384705323528738, 0.5595222910006029, 0.5595222910006029, 0.4759683565493141, 0.4759683565493141, 0.39747664922490095, 0.39747664922490095, 0.3353117614450687, 0.3353117614450687, 0.2838591795998026, 0.2838591795998026, 0.24044467440232514, 0.24044467440232514, 0.20211941220303486, 0.20211941220303486, 0.17089829823948852, 0.17089829823948852, 0.1450068343314957, 0.1450068343314957, 0.12343175431835024, 0.12343175431835024, 0.10495324031438266, 0.10495324031438266, 0.08936679243295703, 0.08936679243295703, 0.07636839662855605, 0.07636839662855605, 0.06535310256763628, 0.06535310256763628, 0.056049383644865086, 0.056049383644865086, 0.048251372081388216, 0.048251372081388216, 0.041538782993132836, 0.041538782993132836, 0.035747811286957455, 0.035747811286957455, 0.030730382630231035, 0.030730382630231035, 0.026281313190208492, 0.026281313190208492, 0.022213543706037227, 0.022213543706037227, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999603995202802, 0.999603995202802, 0.9986789580901763, 0.9986789580901763, 0.9963104527141888, 0.9963104527141888, 0.9920860595710221, 0.9920860595710221, 0.9849278795926554, 0.9849278795926554, 0.9727994632390935, 0.9727994632390935, 0.9519100392003712, 0.9519100392003712, 0.9208773523898958, 0.9208773523898958, 0.8770281994400533, 0.8770281994400533, 0.8188401163118754, 0.8188401163118754, 0.7449930870147018, 0.7449930870147018, 0.6615673924588786, 0.6615673924588786, 0.574471643081355, 0.574471643081355, 0.4909495121241417, 0.4909495121241417, 0.41274061651586225, 0.41274061651586225, 0.34400403254625955, 0.34400403254625955, 0.2850547173985973, 0.2850547173985973, 0.23655507287958752, 0.23655507287958752, 0.19540374535728833, 0.19540374535728833, 0.16016205419110208, 0.16016205419110208, 0.1325381547886316, 0.1325381547886316, 0.11022646481593129, 0.11022646481593129, 0.09192030523146959, 0.09192030523146959, 0.07662556036559655, 0.07662556036559655, 0.0639759770768622, 0.0639759770768622, 0.05352254474460939, 0.05352254474460939, 0.04469656217907966, 0.04469656217907966, 0.037165631571225974, 0.037165631571225974, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9995602226518163, 0.9995602226518163, 0.9986088536139883, 0.9986088536139883, 0.9962191459086173, 0.9962191459086173, 0.9920204007445438, 0.9920204007445438, 0.9848707700925413, 0.9848707700925413, 0.972799121266039, 0.972799121266039, 0.9514658162024782, 0.9514658162024782, 0.9189670909070391, 0.9189670909070391, 0.8727484066620455, 0.8727484066620455, 0.8128908110814317, 0.8128908110814317, 0.7393785734046872, 0.7393785734046872, 0.6587344876747782, 0.6587344876747782, 0.5713183095451178, 0.5713183095451178, 0.48632535248017666, 0.48632535248017666, 0.4062930565449026, 0.4062930565449026, 0.3353986226009308, 0.3353986226009308, 0.27530609153182384, 0.27530609153182384, 0.22597066486743245, 0.22597066486743245, 0.18433681336512772, 0.18433681336512772, 0.148790424207315, 0.148790424207315, 0.12110804741251217, 0.12110804741251217, 0.09939173252782721, 0.09939173252782721, 0.08160639790548344, 0.08160639790548344, 0.0664932407315898, 0.0664932407315898, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9995263673194135, 0.9995263673194135, 0.9985661069821664, 0.9985661069821664, 0.9961353625102464, 0.9961353625102464, 0.991994410792396, 0.991994410792396, 0.9849904606616426, 0.9849904606616426, 0.9733370448808857, 0.9733370448808857, 0.9528908179208927, 0.9528908179208927, 0.9223427069287503, 0.9223427069287503, 0.8777921672439741, 0.8777921672439741, 0.8204532032103062, 0.8204532032103062, 0.7487301685550989, 0.7487301685550989, 0.6696824130439466, 0.6696824130439466, 0.5833615746080903, 0.5833615746080903, 0.49817164106371403, 0.49817164106371403, 0.4171418097282443, 0.4171418097282443, 0.34451938593950426, 0.34451938593950426, 0.2823014923362129, 0.2823014923362129, 0.23136221204586405, 0.23136221204586405, 0.18839945325348034, 0.18839945325348034, 0.15151731734449717, 0.15151731734449717, 0.12188672005777977, 0.12188672005777977, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9997394165324137, 0.9997394165324137, 0.9989046603061958, 0.9989046603061958, 0.9970826278714195, 0.9970826278714195, 0.9934737862264881, 0.9934737862264881, 0.9876428036729274, 0.9876428036729274, 0.9780891024472618, 0.9780891024472618, 0.9607955250773971, 0.9607955250773971, 0.9340662271856951, 0.9340662271856951, 0.8939415027732305, 0.8939415027732305, 0.8419530491514452, 0.8419530491514452, 0.7740211277792578, 0.7740211277792578, 0.6975761291864769, 0.6975761291864769, 0.6128947095742538, 0.6128947095742538, 0.5274058915801788, 0.5274058915801788, 0.4446648270796151, 0.4446648270796151, 0.3689051424882028, 0.3689051424882028, 0.30293751434149496, 0.30293751434149496, 0.248556617229902, 0.248556617229902, 0.2031808965644361, 0.2031808965644361, 0.16378970435403511, 0.16378970435403511, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9997835310564539, 0.9997835310564539, 0.9989689512404559, 0.9989689512404559, 0.9972584020214711, 0.9972584020214711, 0.993724110502437, 0.993724110502437, 0.9880695860450371, 0.9880695860450371, 0.9787651831761568, 0.9787651831761568, 0.962003715879211, 0.962003715879211, 0.9359539184469499, 0.9359539184469499, 0.8966649761798668, 0.8966649761798668, 0.8455940362635066, 0.8455940362635066, 0.7784445492401871, 0.7784445492401871, 0.7023326324025625, 0.7023326324025625, 0.61792034558429, 0.61792034558429, 0.5323402207846435, 0.5323402207846435, 0.4493214741637647, 0.4493214741637647, 0.3729116987956051, 0.3729116987956051, 0.30629090211465876, 0.30629090211465876, 0.25126812157962825, 0.25126812157962825, 0.20534387613462385, 0.20534387613462385, 0.16561139481575687, 0.16561139481575687, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999599207580038, 0.999599207580038, 0.9987285441830897, 0.9987285441830897, 0.9963596968340477, 0.9963596968340477, 0.9920908471937863, 0.9920908471937863, 0.9851888050332962, 0.9851888050332962, 0.9736451626030579, 0.9736451626030579, 0.9530310268732686, 0.9530310268732686, 0.9207556099824671, 0.9207556099824671, 0.8739025657212366, 0.8739025657212366, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999899459921955, 0.999899459921955, 0.9992380840344066, 0.9992380840344066, 0.9978746374658155, 0.9978746374658155, 0.9945082547165779, 0.9945082547165779, 0.9889399074689309, 0.9889399074689309, 0.9800359550469581, 0.9800359550469581, 0.0]]
dictt = {'Z_re': [7.244169989278031, 9.513502258205108, 11.177308576168459, 12.189721548998627, 12.938898459985772, 13.521449558454517, 13.761147196208634, 13.771137066617802, 14.93740846244985, 14.991938020133592], 'F_star': [-1.0, -0.6666666666666667, -0.33333333333333337, 0.0, 0.33333333333333326, 0.6666666666666665, 1.0, 1.333333333333333, 1.6666666666666665, 2.0], 'medians': [array([3.05868287, 1.0519284 , 2.3070002 , 0.0729333 ]), array([2.35592435, 1.00205986, 1.45401669, 0.04076315]), array([3.30520706, 1.00329443, 1.86664061, 0.04451797]), array([1.78181097, 1.04856106, 0.636654  , 0.07425112]), array([2.26462995, 1.03687408, 0.76034869, 0.04478501]), array([2.99205669, 0.98416548, 1.29871994, 0.05403847]), array([3.23255398, 0.92466863, 1.83411205, 0.05546749]), array([2.73005278, 1.00404225, 1.03278857, 0.04296019]), array([3.32475602, 0.57305819, 2.99252662, 0.00917318]), array([5.76532979e-01, 1.37471215e+00, 1.74459476e-04, 4.42882851e-03])], 'a16': [array([1.39710329]), array([1.53445341]), array([1.85587202]), array([1.98769915]), array([1.9808056]), array([1.88213318]), array([1.90873408]), array([1.80308036]), array([0.42119911]), array([0.53747949])], 'a50': [array([2.23249002]), array([2.26360528]), array([2.62885488]), array([2.74582698]), array([2.76580072]), array([2.74052036]), array([2.72218252]), array([2.68000971]), array([2.86671561]), array([0.92123502])], 'a84': [array([3.05994511]), array([3.04868769]), array([3.2253688]), array([3.27771931]), array([3.28922603]), array([3.28465559]), array([3.28216035]), array([3.26615902]), array([3.26394407]), array([3.12061545])], 'b16': [array([1.03517124]), array([0.98637748]), array([0.99330765]), array([0.99677974]), array([0.98821683]), array([0.96170329]), array([0.93461949]), array([0.93340349]), array([0.51716559]), array([0.52317632])], 'b50': [array([1.06347453]), array([1.00364312]), array([1.01255464]), array([1.01899488]), array([1.01395305]), array([0.99017177]), array([0.96472993]), array([0.96508435]), array([0.55972921]), array([0.67356639])], 'b84': [array([1.13064555]), array([1.03135136]), array([1.04023299]), array([1.05016894]), array([1.04932975]), array([1.02646223]), array([0.9958935]), array([0.99836291]), array([0.82260095]), array([1.14400048])], 'k16': [array([0.92943387]), array([0.85071869]), array([0.86493582]), array([0.78886684]), array([0.71429197]), array([0.64676299]), array([0.69507166]), array([0.64615028]), array([0.00147285]), array([0.00025037])], 'k50': [array([1.77308491]), array([1.46090875]), array([1.38847282]), array([1.21608504]), array([1.12566771]), array([1.0902199]), array([1.11722237]), array([1.09152279]), array([2.3694653]), array([0.00385847])], 'k84': [array([2.65241335]), array([2.13163049]), array([1.82509899]), array([1.57938265]), array([1.4543686]), array([1.44055543]), array([1.47359755]), array([1.46452898]), array([3.19166413]), array([0.18747235])], 'p16': [array([0.05727746]), array([0.03475145]), array([0.03823227]), array([0.04287266]), array([0.0454424]), array([0.04555458]), array([0.04430541]), array([0.04482755]), array([0.01168919]), array([0.00420016])], 'p50': [array([0.067428]), array([0.04136084]), array([0.04522813]), array([0.05082259]), array([0.0538554]), array([0.05458808]), array([0.052591]), array([0.05287072]), array([0.01420588]), array([0.00533231])], 'p84': [array([0.08151909]), array([0.04998661]), array([0.05503271]), array([0.06152436]), array([0.06555209]), array([0.06701281]), array([0.06339345]), array([0.0640353]), array([0.01808436]), array([0.00678716])], 'width50': [1.8181818181818183, 1.616161616161616, 1.4141414141414153, 1.4141414141414153, 1.4141414141414153, 1.4141414141414135, 1.2121212121212128, 1.4141414141414135, 0.0, 0.0], 'width90': [5.454545454545453, 4.848484848484848, 4.242424242424242, 3.8383838383838373, 3.4343434343434343, 2.8282828282828287, 2.6262626262626263, 2.6262626262626263, 0.40404040404040487, 0.0]}

#varyinh F_esc10_only:
ion_rates = [[0.6973046025811442, 0.6973046025811442, 0.6973046025811442, 0.6349181162619473, 0.6349181162619473, 0.5750294011333671, 0.5750294011333671, 0.5207350232045816, 0.5207350232045816, 0.4718345862656098, 0.4718345862656098, 0.4272611343861772, 0.4272611343861772, 0.38629036863669364, 0.38629036863669364, 0.3390515787699024, 0.3390515787699024, 0.2834173504132915, 0.2834173504132915, 0.2535589990722271, 0.2535589990722271, 0.22860625119904301, 0.22860625119904301, 0.20597379050115125, 0.20597379050115125, 0.1855073871309384, 0.1855073871309384, 0.16714856369607214, 0.16714856369607214, 0.15040761478240083, 0.15040761478240083, 0.13531053034207222, 0.13531053034207222, 0.12180498849773631, 0.12180498849773631, 0.10971589904545061, 0.10971589904545061, 0.09862400302030602, 0.09862400302030602, 0.08861445171289173, 0.08861445171289173, 0.07943281717060385, 0.07943281717060385, 0.07107567966289664, 0.07107567966289664, 0.06358510187548283, 0.06358510187548283, 0.05657362833752877, 0.05657362833752877, 0.0501828358936286, 0.0501828358936286, 0.04430363513937283, 0.04430363513937283, 0.03885190070333598, 0.03885190070333598, 0.033793093307005966, 0.033793093307005966, 0.02274873153644732, 0.02274873153644732, 0.017511414205629083, 0.017511414205629083, 0.013587957350488525, 0.013587957350488525, 0.011394542178443592, 0.011394542178443592, 0.008503843948119951, 0.008503843948119951, 0.00707337066083215, 0.00707337066083215, 0.005177472046267587, 0.005177472046267587, 0.004251750987532689, 0.004251750987532689, 0.003118452284670682, 0.003118452284670682, 0.0025671917206955596, 0.0025671917206955596, 0.002101424420364222, 0.002101424420364222, 0.001523489958132239, 0.001523489958132239, 0.001235890619234548, 0.001235890619234548, 0.0010088205109966566, 0.0010088205109966566, 0.0007126718457345872, 0.0007126718457345872, 0.000575540650849957, 0.000575540650849957, 0.0004469587823297051, 0.0004469587823297051, 0.000302646153298997, 0.000302646153298997, 0.00022604418907416608, 0.00022604418907416608, 0.00015593971288626284, 0.00015593971288626284, 0.00011250913495522034, 0.00011250913495522034, 0.0], [0.9891721071729874, 0.9891721071729874, 0.9891721071729874, 0.9777744872370526, 0.9777744872370526, 0.9583938483151159, 0.9583938483151159, 0.9294451452992213, 0.9294451452992213, 0.8885000275288308, 0.8885000275288308, 0.8350787068083757, 0.8350787068083757, 0.7747211466219731, 0.7747211466219731, 0.7087979749723601, 0.7087979749723601, 0.6409860861423285, 0.6409860861423285, 0.5758586857907118, 0.5758586857907118, 0.5141140828949524, 0.5141140828949524, 0.4595474944147251, 0.4595474944147251, 0.41049727327784935, 0.41049727327784935, 0.3617722685158746, 0.3617722685158746, 0.300436665393387, 0.300436665393387, 0.2603098891425949, 0.2603098891425949, 0.23075999749675724, 0.23075999749675724, 0.2050956036970023, 0.2050956036970023, 0.18225727522025628, 0.18225727522025628, 0.16201794195828134, 0.16201794195828134, 0.14414608815313007, 0.14414608815313007, 0.12815679601341493, 0.12815679601341493, 0.11414992167107185, 0.11414992167107185, 0.10174416517024958, 0.10174416517024958, 0.09072442545962034, 0.09072442545962034, 0.08096212067066387, 0.08096212067066387, 0.0721532367578629, 0.0721532367578629, 0.0643942101226076, 0.0643942101226076, 0.0573916278840725, 0.0573916278840725, 0.05112531363203768, 0.05112531363203768, 0.045375720665465885, 0.045375720665465885, 0.04017020682872314, 0.04017020682872314, 0.03539660495990879, 0.03539660495990879, 0.031004645020000294, 0.031004645020000294, 0.026861299490767925, 0.026861299490767925, 0.017791148164271544, 0.017791148164271544, 0.013582827754669898, 0.013582827754669898, 0.010423680676504775, 0.010423680676504775, 0.00867072679875262, 0.00867072679875262, 0.00648893871056324, 0.00648893871056324, 0.005323836513625745, 0.005323836513625745, 0.003893705199392519, 0.003893705199392519, 0.0031704321889661027, 0.0031704321889661027, 0.0023517486963132227, 0.0023517486963132227, 0.001937961300277306, 0.001937961300277306, 0.0015723921049364837, 0.0015723921049364837, 0.0011319308106437062, 0.0011319308106437062, 0.0008997311065871876, 0.0008997311065871876, 0.0007181434146077894, 0.0007181434146077894, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 0.9999938444850176, 0.9999938444850176, 0.9997100068497203, 0.9997100068497203, 0.9987740265993481, 0.9987740265993481, 0.995953774818267, 0.995953774818267, 0.9909257449968487, 0.9909257449968487, 0.9818733762691902, 0.9818733762691902, 0.9658122697880144, 0.9658122697880144, 0.9412083344304969, 0.9412083344304969, 0.9054451343560835, 0.9054451343560835, 0.8569998635527513, 0.8569998635527513, 0.7980033561235576, 0.7980033561235576, 0.7331892030899317, 0.7331892030899317, 0.6628238014613876, 0.6628238014613876, 0.5928533787108778, 0.5928533787108778, 0.5252073468123153, 0.5252073468123153, 0.4632007925567513, 0.4632007925567513, 0.40709429941177216, 0.40709429941177216, 0.3436976246893602, 0.3436976246893602, 0.2895639740962251, 0.2895639740962251, 0.2505284338625822, 0.2505284338625822, 0.21870647324214737, 0.21870647324214737, 0.1914166815139968, 0.1914166815139968, 0.16804384915294984, 0.16804384915294984, 0.14748374516578341, 0.14748374516578341, 0.12946415900105568, 0.12946415900105568, 0.11400937074564146, 0.11400937074564146, 0.10031916345183498, 0.10031916345183498, 0.08861923933565578, 0.08861923933565578, 0.07834739469538238, 0.07834739469538238, 0.06934939968340134, 0.06934939968340134, 0.06157430031458101, 0.06157430031458101, 0.05458334515990147, 0.05458334515990147, 0.048326948126449325, 0.048326948126449325, 0.042755181148256605, 0.042755181148256605, 0.037739120383748485, 0.037739120383748485, 0.0332479882580132, 0.0332479882580132, 0.029226727109264154, 0.029226727109264154, 0.025571377128910503, 0.025571377128910503, 0.022210123975491474, 0.022210123975491474, 0.014506838948131921, 0.014506838948131921, 0.010928432905057678, 0.010928432905057678, 0.008286691058464739, 0.008286691058464739, 0.006832963603465829, 0.006832963603465829, 0.005063936992148641, 0.005063936992148641, 0.00416865153527093, 0.00416865153527093, 0.0030103887994249383, 0.0030103887994249383, 0.0024088581964272705, 0.0024088581964272705, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999924765927993, 0.9999924765927993, 0.9997100068497203, 0.9997100068497203, 0.9988362656952808, 0.9988362656952808, 0.99620888671698, 0.99620888671698, 0.991650727872548, 0.991650727872548, 0.9834666287304558, 0.9834666287304558, 0.9688346276443494, 0.9688346276443494, 0.9457976128228952, 0.9457976128228952, 0.911875937647369, 0.911875937647369, 0.8661476427626361, 0.8661476427626361, 0.8071278811657314, 0.8071278811657314, 0.7404417676313613, 0.7404417676313613, 0.6677926699443644, 0.6677926699443644, 0.5925086698718661, 0.5925086698718661, 0.5190627749677091, 0.5190627749677091, 0.4414366014444258, 0.4414366014444258, 0.3692488254080508, 0.3692488254080508, 0.3155145993426594, 0.3155145993426594, 0.2714151221168679, 0.2714151221168679, 0.23233580933223946, 0.23233580933223946, 0.19913501335575765, 0.19913501335575765, 0.1718199156215685, 0.1718199156215685, 0.14866970771905, 0.14866970771905, 0.12884860750282043, 0.12884860750282043, 0.11168156016314851, 0.11168156016314851, 0.09704032580456856, 0.09704032580456856, 0.08456309693534007, 0.08456309693534007, 0.07378752598567749, 0.07378752598567749, 0.06466813053932229, 0.06466813053932229, 0.056674852361683015, 0.056674852361683015, 0.04979264463835836, 0.04979264463835836, 0.04360156445833007, 0.04360156445833007, 0.03817205827084061, 0.03817205827084061, 0.033481897827342594, 0.033481897827342594, 0.029256478765012188, 0.029256478765012188, 0.025492381353303648, 0.025492381353303648, 0.02205076453205946, 0.02205076453205946, 0.014783837122337783, 0.014783837122337783, 0.011337432678329543, 0.011337432678329543, 0.00942101568049047, 0.00942101568049047, 0.006939317223438697, 0.006939317223438697, 0.005084113402368574, 0.005084113402368574, 0.004128982660940214, 0.004128982660940214, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999391287962857, 0.9999391287962857, 0.999417277915004, 0.999417277915004, 0.9979536332414224, 0.9979536332414224, 0.9944443057553723, 0.9944443057553723, 0.9883493200036796, 0.9883493200036796, 0.9778904161025536, 0.9778904161025536, 0.9588647452112659, 0.9588647452112659, 0.9297775431082683, 0.9297775431082683, 0.8885673962205822, 0.8885673962205822, 0.8333079703317857, 0.8333079703317857, 0.7648090576351126, 0.7648090576351126, 0.6859343404895755, 0.6859343404895755, 0.5962351502475713, 0.5962351502475713, 0.5132847982376076, 0.5132847982376076, 0.43610797730803597, 0.43610797730803597, 0.3689957653476652, 0.3689957653476652, 0.31222242474626455, 0.31222242474626455, 0.26473023284603314, 0.26473023284603314, 0.22403680724381003, 0.22403680724381003, 0.18921540096169662, 0.18921540096169662, 0.16112505031278565, 0.16112505031278565, 0.13808085405718543, 0.13808085405718543, 0.11889377188413816, 0.11889377188413816, 0.10230568492586195, 0.10230568492586195, 0.08869481538071688, 0.08869481538071688, 0.07686665136907203, 0.07686665136907203, 0.06699491520265152, 0.06699491520265152, 0.05865556029378221, 0.05865556029378221, 0.051454633683593536, 0.051454633683593536, 0.04518489970101296, 0.04518489970101296, 0.03964493621689573, 0.03964493621689573, 0.03486791461753563, 0.03486791461753563, 0.03065480658516993, 0.03065480658516993, 0.026920802802264, 0.026920802802264, 0.02352364247811458, 0.02352364247811458, 0.020442123283338012, 0.020442123283338012, 0.013357125538650308, 0.013357125538650308, 0.010201056217976361, 0.010201056217976361, 0.008533253630813413, 0.008533253630813413, 0.006153805117079605, 0.006153805117079605, 0.0043991413740545725, 0.0043991413740545725, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9997548053198696, 0.9997548053198696, 0.998848234752191, 0.998848234752191, 0.9961445957827199, 0.9961445957827199, 0.9911596545661782, 0.9911596545661782, 0.9823059721832278, 0.9823059721832278, 0.9664192719598852, 0.9664192719598852, 0.9396769790921095, 0.9396769790921095, 0.898269855724988, 0.898269855724988, 0.8428551740694143, 0.8428551740694143, 0.7720571765268327, 0.7720571765268327, 0.692955047300003, 0.692955047300003, 0.607649868836235, 0.607649868836235, 0.5209429428217633, 0.5209429428217633, 0.43976708899198996, 0.43976708899198996, 0.36806799245060284, 0.36806799245060284, 0.30849594437055927, 0.30849594437055927, 0.25923506783206524, 0.25923506783206524, 0.2180044025611046, 0.2180044025611046, 0.1824798996787847, 0.1824798996787847, 0.15440698965565708, 0.15440698965565708, 0.13169861093964963, 0.13169861093964963, 0.11308912125577977, 0.11308912125577977, 0.097133342475413, 0.097133342475413, 0.08411511223384664, 0.08411511223384664, 0.0729014738012733, 0.0729014738012733, 0.06350508018071224, 0.06350508018071224, 0.05565201095544878, 0.05565201095544878, 0.048936002136647644, 0.048936002136647644, 0.043075267927338935, 0.043075267927338935, 0.038001071743553036, 0.038001071743553036, 0.033582095932333106, 0.033582095932333106, 0.029649405804719024, 0.029649405804719024, 0.026212918579293462, 0.026212918579293462, 0.023038724686727033, 0.023038724686727033, 0.020185985465461236, 0.020185985465461236, 0.013459375481968273, 0.013459375481968273, 0.011572368166822663, 0.011572368166822663, 0.008737753517449346, 0.008737753517449346, 0.0074327843411906205, 0.0074327843411906205, 0.005170974558230659, 0.005170974558230659, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9998231999307846, 0.9998231999307846, 0.9989610858602007, 0.9989610858602007, 0.9964024434658696, 0.9964024434658696, 0.991348081719249, 0.991348081719249, 0.982236551653149, 0.982236551653149, 0.9661511650850982, 0.9661511650850982, 0.9383190040923916, 0.9383190040923916, 0.8968896524767227, 0.8968896524767227, 0.8412820980183687, 0.8412820980183687, 0.7691664782965091, 0.7691664782965091, 0.6884129611891361, 0.6884129611891361, 0.6018260677168203, 0.6018260677168203, 0.5137775814092505, 0.5137775814092505, 0.43182544874559153, 0.43182544874559153, 0.3597662545777368, 0.3597662545777368, 0.30031731679734025, 0.30031731679734025, 0.25144150191829784, 0.25144150191829784, 0.2107227703100362, 0.2107227703100362, 0.1758172386564973, 0.1758172386564973, 0.1484357981497206, 0.1484357981497206, 0.12641923092311863, 0.12641923092311863, 0.10851933532749221, 0.10851933532749221, 0.09309053702422572, 0.09309053702422572, 0.08059928725975965, 0.08059928725975965, 0.06986030742693661, 0.06986030742693661, 0.060842477977790216, 0.060842477977790216, 0.05342268861267345, 0.05342268861267345, 0.04706677742033994, 0.04706677742033994, 0.041523052232622384, 0.041523052232622384, 0.03676278731293647, 0.03676278731293647, 0.03259858142737501, 0.03259858142737501, 0.028861841860032482, 0.028861841860032482, 0.02560762627269547, 0.02560762627269547, 0.022630750832618896, 0.022630750832618896, 0.019923692132602103, 0.019923692132602103, 0.013423810284292459, 0.013423810284292459, 0.011731385637200102, 0.011731385637200102, 0.010092308786621467, 0.010092308786621467, 0.007179382307750443, 0.007179382307750443, 0.004934329204464663, 0.004934329204464663, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999824567823003, 0.999824567823003, 0.9989443291805266, 0.9989443291805266, 0.9963049811453156, 0.9963049811453156, 0.9911791470302889, 0.9911791470302889, 0.982013585221566, 0.982013585221566, 0.9657083099794235, 0.9657083099794235, 0.937399438548639, 0.937399438548639, 0.8952423682728343, 0.8952423682728343, 0.8388151044026637, 0.8388151044026637, 0.7657918881939616, 0.7657918881939616, 0.6842282369203001, 0.6842282369203001, 0.5969635528538164, 0.5969635528538164, 0.5085016211232652, 0.5085016211232652, 0.4263378071388243, 0.4263378071388243, 0.35430220911173527, 0.35430220911173527, 0.29494662997523774, 0.29494662997523774, 0.24639671541720543, 0.24639671541720543, 0.20613349191763783, 0.20613349191763783, 0.1716318304415522, 0.1716318304415522, 0.14467477849550323, 0.14467477849550323, 0.12312945013810582, 0.12312945013810582, 0.1056005953066934, 0.1056005953066934, 0.09055925247426054, 0.09055925247426054, 0.0784226287673889, 0.0784226287673889, 0.06798868889924688, 0.06798868889924688, 0.05931762012743968, 0.05931762012743968, 0.05219774113118531, 0.05219774113118531, 0.04612053797833054, 0.04612053797833054, 0.040787810165285834, 0.040787810165285834, 0.03625256351551036, 0.03625256351551036, 0.03224874299254465, 0.03224874299254465, 0.0286016003655008, 0.0286016003655008, 0.025444847098717704, 0.025444847098717704, 0.022527474970137202, 0.022527474970137202, 0.019886417069653415, 0.019886417069653415, 0.013430991718438538, 0.013430991718438538, 0.011789521056477875, 0.011789521056477875, 0.01019968832575806, 0.01019968832575806, 0.007488525949086368, 0.007488525949086368, 0.006336760701277304, 0.006336760701277304, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9998225159846755, 0.9998225159846755, 0.9989361218272167, 0.9989361218272167, 0.9962656542440395, 0.9962656542440395, 0.9911001512546821, 0.9911001512546821, 0.9818620911583893, 0.9818620911583893, 0.9654053218530699, 0.9654053218530699, 0.9367698661551662, 0.9367698661551662, 0.8941377953065566, 0.8941377953065566, 0.8372112507767063, 0.8372112507767063, 0.7636316444082105, 0.7636316444082105, 0.681605987537818, 0.681605987537818, 0.5939514541891187, 0.5939514541891187, 0.5051256631284995, 0.5051256631284995, 0.422820614272519, 0.422820614272519, 0.3507651818082646, 0.3507651818082646, 0.29140447307594847, 0.29140447307594847, 0.2430556386740063, 0.2430556386740063, 0.20298631389638286, 0.20298631389638286, 0.16867889311529588, 0.16867889311529588, 0.14205013530163904, 0.14205013530163904, 0.12078556682204783, 0.12078556682204783, 0.1035511507906246, 0.1035511507906246, 0.08879125178210708, 0.08879125178210708, 0.07694051754886025, 0.07694051754886025, 0.066710393621245, 0.066710393621245, 0.05827768006847668, 0.05827768006847668, 0.05140333772540726, 0.05140333772540726, 0.04550977410285934, 0.04550977410285934, 0.04030904788888064, 0.04030904788888064, 0.035934186601700904, 0.035934186601700904, 0.031993289120777015, 0.031993289120777015, 0.028396758505810294, 0.028396758505810294, 0.025268389002556933, 0.025268389002556933, 0.022397867182453225, 0.022397867182453225, 0.01978245726106257, 0.01978245726106257, 0.013340026885921551, 0.013340026885921551, 0.011716680795853371, 0.011716680795853371, 0.010129925822624732, 0.010129925822624732, 0.007430732502863169, 0.007430732502863169, 0.006288542500582209, 0.006288542500582209, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9998218320385663, 0.9998218320385663, 0.9989279144739069, 0.9989279144739069, 0.9962376124535643, 0.9962376124535643, 0.9910464614851138, 0.9910464614851138, 0.9817704423797631, 0.9817704423797631, 0.9652110811580712, 0.9652110811580712, 0.9363745453040773, 0.9363745453040773, 0.8933734855295812, 0.8933734855295812, 0.8360943667804639, 0.8360943667804639, 0.7621444035938633, 0.7621444035938633, 0.6797473639862021, 0.6797473639862021, 0.5918555013376277, 0.5918555013376277, 0.5027188567703996, 0.5027188567703996, 0.42031566164775613, 0.42031566164775613, 0.3481918345725867, 0.3481918345725867, 0.28875794360659146, 0.28875794360659146, 0.24053837501927874, 0.24053837501927874, 0.2007214263559317, 0.2007214263559317, 0.1666027747009702, 0.1666027747009702, 0.1403050468041421, 0.1403050468041421, 0.11929969389991885, 0.11929969389991885, 0.10220104117116197, 0.10220104117116197, 0.08758955846833005, 0.08758955846833005, 0.0758793751605136, 0.0758793751605136, 0.06581100448771239, 0.06581100448771239, 0.05753559854004864, 0.05753559854004864, 0.050820957613465806, 0.050820957613465806, 0.045067602943293684, 0.045067602943293684, 0.04000195608587217, 0.04000195608587217, 0.03576867164328654, 0.03576867164328654, 0.031865391198365914, 0.031865391198365914, 0.028281171613363895, 0.028281171613363895, 0.02517503035865792, 0.02517503035865792, 0.022336995978738852, 0.022336995978738852, 0.019729793410658, 0.019729793410658, 0.013295228415772208, 0.013295228415772208, 0.011679405732904682, 0.011679405732904682, 0.010098806274658395, 0.010098806274658395, 0.007400638874060558, 0.007400638874060558, 0.006264262413707374, 0.006264262413707374, 0.0]]
dictt = {'Z_re': [4.920419743589585, 7.528709520780395, 8.758991823794156, 9.499966685543347, 9.704293701310675, 9.70747886625715, 9.685308753129041, 9.670137153458027, 9.659702927449167, 9.652420227404681], 'F_star': [-1.3, -0.9333333333333333, -0.5666666666666668, -0.20000000000000018, 0.16666666666666652, 0.5333333333333332, 0.8999999999999997, 1.2666666666666664, 1.633333333333333, 2.0], 'medians': [array([3.40368906, 1.29555027, 2.61632326, 0.12290196]), array([1.63260131, 1.04383849, 1.19021808, 0.04624629]), array([2.72803571, 0.99970889, 1.89008829, 0.03084827]), array([3.18731143, 1.01151469, 1.80957472, 0.04619425]), array([2.31971728, 1.04018254, 1.15653337, 0.03375008]), array([2.46887181, 1.00831213, 1.42127665, 0.04675007]), array([2.67697306, 0.98038373, 1.69175085, 0.06133389]), array([3.05766819, 1.01147674, 1.71620632, 0.04563831]), array([2.66294846, 1.01615697, 1.3810611 , 0.05831475]), array([2.2284642 , 0.98901347, 1.44765692, 0.07447079])], 'a16': [array([2.09351832]), array([1.24224266]), array([1.32902732]), array([1.56943334]), array([1.71656221]), array([1.692857]), array([1.82895797]), array([1.78269026]), array([1.85499211]), array([1.88252794])], 'a50': [array([2.54984792]), array([2.01750931]), array([2.04742845]), array([2.36388116]), array([2.49450036]), array([2.51622626]), array([2.62700826]), array([2.60924422]), array([2.65247945]), array([2.69162026])], 'a84': [array([3.15112016]), array([2.92694204]), array([2.9155583]), array([3.11584411]), array([3.19723286]), array([3.19434403]), array([3.22278823]), array([3.23567114]), array([3.26090614]), array([3.25634104])], 'b16': [array([1.3168713]), array([1.00216857]), array([0.98448776]), array([0.99131582]), array([0.99778957]), array([1.00307751]), array([1.00701915]), array([1.01110497]), array([1.01263398]), array([1.01332162])], 'b50': [array([1.41239161]), array([1.02429149]), array([1.00209108]), array([1.00945816]), array([1.01775951]), array([1.02579198]), array([1.02943335]), array([1.03398873]), array([1.03520607]), array([1.03629806])], 'b84': [array([1.53210032]), array([1.07900147]), array([1.03790292]), array([1.04331751]), array([1.05144102]), array([1.06682316]), array([1.06458783]), array([1.07577311]), array([1.07263269]), array([1.0738764])], 'k16': [array([1.31088079]), array([0.77225613]), array([0.7390893]), array([0.80430108]), array([0.81694281]), array([0.75113122]), array([0.82045483]), array([0.76264198]), array([0.80569124]), array([0.80968278])], 'k50': [array([1.70717993]), array([1.5690617]), array([1.39054093]), array([1.42370675]), array([1.36756676]), array([1.29464177]), array([1.32168521]), array([1.28950717]), array([1.30286454]), array([1.30713326])], 'k84': [array([2.26227493]), array([2.54443998]), array([2.18344311]), array([2.03025751]), array([1.87719596]), array([1.77078642]), array([1.74491809]), array([1.71254695]), array([1.70836397]), array([1.68859045])], 'p16': [array([0.10285284]), array([0.04235231]), array([0.03411896]), array([0.0373961]), array([0.04067956]), array([0.04273605]), array([0.0438528]), array([0.04441635]), array([0.04466445]), array([0.04497496])], 'p50': [array([0.11943392]), array([0.04996436]), array([0.04023336]), array([0.04399605]), array([0.048156]), array([0.05086948]), array([0.05163257]), array([0.05242276]), array([0.05317215]), array([0.05335719])], 'p84': [array([0.13676893]), array([0.05976075]), array([0.04919347]), array([0.0534973]), array([0.05821445]), array([0.06187857]), array([0.06227679]), array([0.06326632]), array([0.06483008]), array([0.06435588])], 'width50': [2.121212121212121, 1.8181818181818183, 1.8181818181818183, 1.616161616161616, 1.4141414141414135, 1.4141414141414135, 1.4141414141414135, 1.2121212121212128, 1.2121212121212128, 1.2121212121212128], 'width90': [5.151515151515152, 5.454545454545456, 5.05050505050505, 4.646464646464647, 4.444444444444443, 4.242424242424242, 4.242424242424242, 4.242424242424242, 4.242424242424242, 4.242424242424242]}

#varying F_star
ion_rates = [[0.9955293862575392, 0.9955293862575392, 0.9955293862575392, 0.9896546311529929, 0.9896546311529929, 0.9789238586734796, 0.9789238586734796, 0.9608628937691484, 0.9608628937691484, 0.9337563995982501, 0.9337563995982501, 0.8950515473083814, 0.8950515473083814, 0.8439857369878397, 0.8439857369878397, 0.7860018117732431, 0.7860018117732431, 0.7226413861946162, 0.7226413861946162, 0.6576162357863174, 0.6576162357863174, 0.5947195256696943, 0.5947195256696943, 0.5350630102451708, 0.5350630102451708, 0.4821765353820711, 0.4821765353820711, 0.434696996484859, 0.434696996484859, 0.391960623854604, 0.391960623854604, 0.35183453154992106, 0.35183453154992106, 0.3088386013712436, 0.3088386013712436, 0.25510334938668844, 0.25510334938668844, 0.22257282059717387, 0.22257282059717387, 0.19869762981895606, 0.19869762981895606, 0.17742040833634554, 0.17742040833634554, 0.15844021986131623, 0.15844021986131623, 0.14138978533325444, 0.14138978533325444, 0.12642162473450066, 0.12642162473450066, 0.11309493479770755, 0.11309493479770755, 0.10109783609710256, 0.10109783609710256, 0.0904002350038831, 0.0904002350038831, 0.08104145841932531, 0.08104145841932531, 0.0725027332196387, 0.0725027332196387, 0.06494273490214612, 0.06494273490214612, 0.058081387535150554, 0.058081387535150554, 0.05191800717254284, 0.05191800717254284, 0.046409505209446526, 0.046409505209446526, 0.04131000301962207, 0.04131000301962207, 0.03663146965997961, 0.03663146965997961, 0.03242314925037797, 0.03242314925037797, 0.02850242817967401, 0.02850242817967401, 0.024862466986776244, 0.024862466986776244, 0.016747446401708225, 0.016747446401708225, 0.013148863948414049, 0.013148863948414049, 0.011103181135945574, 0.011103181135945574, 0.008495978567864724, 0.008495978567864724, 0.007118169130981494, 0.007118169130981494, 0.0052639912290750965, 0.0052639912290750965, 0.004366653933869934, 0.004366653933869934, 0.0032179664435520467, 0.0032179664435520467, 0.0026485813076844423, 0.0026485813076844423, 0.0019171009439482225, 0.0019171009439482225, 0.0015638427785721052, 0.0015638427785721052, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999158746285746, 0.9999158746285746, 0.9993830806095465, 0.9993830806095465, 0.9981601849663858, 0.9981601849663858, 0.995266408978571, 0.995266408978571, 0.9905865077267102, 0.9905865077267102, 0.9824889277674255, 0.9824889277674255, 0.968191034355639, 0.968191034355639, 0.9463027070245027, 0.9463027070245027, 0.914223924640082, 0.914223924640082, 0.8708716585385371, 0.8708716585385371, 0.8138161901671119, 0.8138161901671119, 0.7493717100054819, 0.7493717100054819, 0.6786554440229436, 0.6786554440229436, 0.6047684038783848, 0.6047684038783848, 0.5330375038429223, 0.5330375038429223, 0.46581209880148705, 0.46581209880148705, 0.4055475552859288, 0.4055475552859288, 0.342765748115643, 0.342765748115643, 0.2835455903087572, 0.2835455903087572, 0.23907609823791545, 0.23907609823791545, 0.20366342054444161, 0.20366342054444161, 0.17428314753367324, 0.17428314753367324, 0.1495455007118169, 0.1495455007118169, 0.1284266127534747, 0.1284266127534747, 0.11000726008794863, 0.11000726008794863, 0.09445740332336254, 0.09445740332336254, 0.08104556209598021, 0.08104556209598021, 0.06958536109105819, 0.06958536109105819, 0.05984767836203114, 0.05984767836203114, 0.0514867791507236, 0.0514867791507236, 0.044228743040420876, 0.044228743040420876, 0.037810934725209265, 0.037810934725209265, 0.03196422141113813, 0.03196422141113813, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999626565424404, 0.999626565424404, 0.9989114997672873, 0.9989114997672873, 0.9970792081408737, 0.9970792081408737, 0.9938704749697952, 0.9938704749697952, 0.9886386292078502, 0.9886386292078502, 0.9799600370288424, 0.9799600370288424, 0.9646505873216226, 0.9646505873216226, 0.9415537272156178, 0.9415537272156178, 0.9072616952219866, 0.9072616952219866, 0.8619102546433957, 0.8619102546433957, 0.8023231597489507, 0.8023231597489507, 0.7320671894978708, 0.7320671894978708, 0.6522609377516708, 0.6522609377516708, 0.5728565043445967, 0.5728565043445967, 0.4958735821369691, 0.4958735821369691, 0.4237288947054706, 0.4237288947054706, 0.35944787766392733, 0.35944787766392733, 0.303470308360523, 0.303470308360523, 0.2553276837104897, 0.2553276837104897, 0.2122507059178779, 0.2122507059178779, 0.17443395765074088, 0.17443395765074088, 0.0]]
dictt = {'Z_re': [7.861241550761819, 11.534314138108954, 13.697449689883832], 'F_star': [-1.3, -0.20000000000000018, 0.8999999999999997], 'medians': [array([2.34202763, 1.0070942 , 1.84727592, 0.03611621]), array([2.73675277, 0.98876247, 1.62351414, 0.02827698]), array([1.61526864, 0.98428841, 0.54896606, 0.04236768])], 'a16': [array([1.11855688]), array([1.85316125]), array([1.98728067])], 'a50': [array([1.65382996]), array([2.60423607]), array([2.77719551])], 'a84': [array([2.56189851]), array([3.21331843]), array([3.28939148])], 'b16': [array([0.98248315]), array([0.98046564]), array([0.92709258])], 'b50': [array([1.00103849]), array([0.99595799]), array([0.95169039])], 'b84': [array([1.04022477]), array([1.01580503]), array([0.97497823])], 'k16': [array([0.71708021]), array([0.9570489]), array([0.80985907])], 'k50': [array([1.30887046]), array([1.51596768]), array([1.2680632])], 'k84': [array([2.33060938]), array([1.9761647]), array([1.61660999])], 'p16': [array([0.03234868]), array([0.03387012]), array([0.03828535])], 'p50': [array([0.03835001]), array([0.03977632]), array([0.04536456])], 'p84': [array([0.04589118]), array([0.0480758]), array([0.05489966])], 'width50': [2.02020202020202, 1.616161616161616, 1.616161616161616], 'width90': [5.656565656565657, 4.646464646464647, 2.8282828282828287]}


#fix F_star = -1.3 and Fesc10 = -0.1 with varying turnover mass
ion_rates = [[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9998057593050014, 0.9998057593050014, 0.9991255748994514, 0.9991255748994514, 0.9972019764674662, 0.9972019764674662, 0.993584927469225, 0.993584927469225, 0.9873285304357728, 0.9873285304357728, 0.9762992154796155, 0.9762992154796155, 0.9577027207718195, 0.9577027207718195, 0.9295036226915536, 0.9295036226915536, 0.8899824807204141, 0.8899824807204141, 0.8357575233217074, 0.8357575233217074, 0.7722459456529582, 0.7722459456529582, 0.7023261349145256, 0.7023261349145256, 0.6280300949966948, 0.6280300949966948, 0.5552548092525598, 0.5552548092525598, 0.4877500122255367, 0.4877500122255367, 0.4281447927591993, 0.4281447927591993, 0.3740750911272697, 0.3740750911272697, 0.3178236014071507, 0.3178236014071507, 0.2631431358997499, 0.2631431358997499, 0.22446324764286524, 0.22446324764286524, 0.19467602669715242, 0.19467602669715242, 0.16948492360492948, 0.16948492360492948, 0.14760685546543045, 0.14760685546543045, 0.12860991031072697, 0.12860991031072697, 0.11239970357775629, 0.11239970357775629, 0.09829536691485931, 0.09829536691485931, 0.0861816554026442, 0.0861816554026442, 0.07553124659095611, 0.07553124659095611, 0.06622992147956694, 0.06622992147956694, 0.05805539758300284, 0.05805539758300284, 0.05087704119441613, 0.05087704119441613, 0.04454951376561235, 0.04454951376561235, 0.038806076314022914, 0.038806076314022914, 0.0333044138120181, 0.0333044138120181, 0.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9998351689876948, 0.9998351689876948, 0.9991536166899265, 0.9991536166899265, 0.9971493126170616, 0.9971493126170616, 0.9932552654446145, 0.9932552654446145, 0.9865177123233752, 0.9865177123233752, 0.9748711360037097, 0.9748711360037097, 0.9550260976736599, 0.9550260976736599, 0.9254454284529104, 0.9254454284529104, 0.8847372980093406, 0.8847372980093406, 0.8302179018106447, 0.8302179018106447, 0.7657611106190498, 0.7657611106190498, 0.6954415333798188, 0.6954415333798188, 0.6200484439029111, 0.6200484439029111, 0.5462773326238533, 0.5462773326238533, 0.4746640713191645, 0.4746640713191645, 0.40217570096781796, 0.40217570096781796, 0.3355781584545827, 0.3355781584545827, 0.2872546300586792, 0.2872546300586792, 0.24626881749479432, 0.24626881749479432, 0.21118443393371264, 0.21118443393371264, 0.18188965418658803, 0.18188965418658803, 0.1573431703022392, 0.1573431703022392, 0.13657070104818161, 0.13657070104818161, 0.11840406646998657, 0.11840406646998657, 0.10296022135231876, 0.10296022135231876, 0.08992147272747791, 0.08992147272747791, 0.07870167877992222, 0.07870167877992222, 0.06905256707203013, 0.06905256707203013, 0.060749119333891204, 0.060749119333891204, 0.053512627526026715, 0.053512627526026715, 0.047132778219872946, 0.047132778219872946, 0.041654711858633814, 0.041654711858633814, 0.036833233762178945, 0.036833233762178945, 0.032675525364654415, 0.032675525364654415, 0.028945625258403388, 0.028945625258403388, 0.025548122961199394, 0.025548122961199394, 0.022436510137620217, 0.022436510137620217, 0.01949930357187436, 0.01949930357187436, 0.016798742359894495, 0.016798742359894495, 0.0], [0.9999032216255552, 0.9999032216255552, 0.9999032216255552, 0.999153274716872, 0.999153274716872, 0.9966876489933852, 0.9966876489933852, 0.9918018799626702, 0.9918018799626702, 0.9826496551030758, 0.9826496551030758, 0.9662664100044901, 0.9662664100044901, 0.9390679250819111, 0.9390679250819111, 0.8981429837217406, 0.8981429837217406, 0.8404370826005135, 0.8404370826005135, 0.7696606293603702, 0.7696606293603702, 0.6917571156898263, 0.6917571156898263, 0.607962090235062, 0.607962090235062, 0.5241065355496379, 0.5241065355496379, 0.4460597351692271, 0.4460597351692271, 0.37630099373949927, 0.37630099373949927, 0.3180499875692795, 0.3180499875692795, 0.2693054903431939, 0.2693054903431939, 0.2285501676180927, 0.2285501676180927, 0.19289981865168915, 0.19289981865168915, 0.16361564006925639, 0.16361564006925639, 0.1402007450224967, 0.1402007450224967, 0.12073016718720665, 0.12073016718720665, 0.10414242220198501, 0.10414242220198501, 0.08978536745175701, 0.08978536745175701, 0.07772055808634615, 0.07772055808634615, 0.06729003794874987, 0.06729003794874987, 0.058233907517491065, 0.058233907517491065, 0.05054566930453282, 0.05054566930453282, 0.04381119394078463, 0.04381119394078463, 0.03778460280000698, 0.03778460280000698, 0.032233354205088764, 0.032233354205088764, 0.021284744889811153, 0.021284744889811153, 0.015950991157602727, 0.015950991157602727, 0.011874672347067084, 0.011874672347067084, 0.009785900929722143, 0.009785900929722143, 0.006829201899865502, 0.006829201899865502, 0.004842338452783952, 0.004842338452783952, 0.003911487798230426, 0.003911487798230426, 0.0027207376221997964, 0.0027207376221997964, 0.0021752906001524515, 0.0021752906001524515, 0.0014875827874018495, 0.0014875827874018495, 0.0011633923316646188, 0.0011633923316646188, 0.000784144214140791, 0.000784144214140791, 0.0006008466568885171, 0.0006008466568885171, 0.00040216031218036206, 0.00040216031218036206, 0.0002886252580614163, 0.0002886252580614163, 0.00020244804830848157, 0.00020244804830848157, 0.00011319308106437061, 0.00011319308106437061, 7.352420673365463e-05, 7.352420673365463e-05, 0.0]]
dictt = {'Z_re': [11.24982801023544, 10.19418224552251, 7.8794586926664625], 'F_star': [7.0, 8.5, 10.0], 'medians': [array([2.71223593, 0.98922507, 1.70771258, 0.03465792]), array([2.77654118, 0.99119452, 1.85263185, 0.04397251]), array([0.93317569, 1.22101188, 0.27110979, 0.05771002])], 'a16': [array([1.71967996]), array([1.64238293]), array([1.6366154])], 'a50': [array([2.49157668]), array([2.41084191]), array([2.43635082])], 'a84': [array([3.16848003]), array([3.13729423]), array([3.15951288])], 'b16': [array([0.95979479]), array([0.9856963]), array([1.00825712])], 'b50': [array([0.97329339]), array([1.00238506]), array([1.03415444])], 'b84': [array([0.98836078]), array([1.02792733]), array([1.0838243])], 'k16': [array([1.03585825]), array([0.88024884]), array([0.67415346])], 'k50': [array([1.71109032]), array([1.49654441]), array([1.20047337])], 'k84': [array([2.31267699]), array([2.09675445]), array([1.68751772])], 'p16': [array([0.0282025]), array([0.0344949]), array([0.04626969])], 'p50': [array([0.03352446]), array([0.04073482]), array([0.05489873])], 'p84': [array([0.04121903]), array([0.0490892]), array([0.06626482])], 'width50': [1.616161616161616, 1.4141414141414153, 1.4141414141414153], 'width90': [4.8484848484848495, 4.646464646464645, 4.444444444444445]}


pp.plot_multiple_ionhist(ion_rates, dictt,varying_input,zreion=reion_hist_zreion, zreion2=reion_hist_zreion_0593)
pp.plot_variational_range_1dict(dictt, varying_name=varying_input)

bmzs = []


Heff_range = np.linspace(-1.3,-0.7,3)
for Heff in tqdm(Heff_range):
    #adjustable parameters to look out before running the driver
    #change the dimension of the box and see effect

    use_cache = False # uncomment this line to re-use field and work only on MCMC part
    box_dim = 143 #the desired spatial resolution of the box (corrected for Mpc/h instead of MPC to get the deried 100Mpc/h box size
    radius_thick = 2. #the radii thickness (will affect the number of bins and therefore points)
    box_len = 143 #int(143) #default value of 300
    user_params = {"HII_DIM": box_dim, "BOX_LEN": box_len, "DIM":box_len}
    cosmo_params = p21c.CosmoParams(SIGMA_8=0.8, hlittle=0.7, OMm= 0.27, OMb= 0.045)
    astro_params = p21c.AstroParams({ "M_TURN":10, "F_STAR10": Heff, "F_ESC10":-0.08 }) #"HII_EFF_FACTOR":Heff, "M_TURN" : Heff
    flag_options = p21c.FlagOptions({"USE_MASS_DEPENDENT_ZETA": True})
    #add astro_params

    initial_conditions = p21c.initial_conditions(
    user_params = user_params,
    cosmo_params = cosmo_params,
    )



    if os.path.exists('b_mz.npy') and os.path.exists('bmz_errors.npy') and os.path.exists('kvalues.npy') and use_cache and os.path.exists('zre.npy'):
        #bmz_errors = np.load('bmz_errors.npy')
        #b_mz = np.load('b_mz.npy')
        kvalues = np.load('kvalues.npy')
        z_re_box= np.load('zre.npy')
        density_field = np.load('density.npy')
        overzre, zre_mean = zre.over_zre_field(z_re_box)

    else :




        """Compute the over-redshfit or reionization and overdensity"""
        zre_range = np.linspace(5,15,50)
        z_re_box = zre.generate_zre_field(zre_range, initial_conditions,box_dim, astro_params, flag_options,comP_ionization_rate=False)
        overzre, zre_mean = zre.over_zre_field(z_re_box)
        #zre.plot_zre_slice(overzre)
        #np.save('./zre',z_re_box)
        #np.save('./density', perturbed_field.density)
        #np.save('./b_mz', b_mz)
        #np.save('./bmz_errors', bmz_errors)
        #np.save('./kvalues', kvalues)


    """This section uses the redshfit of reionization field to evaluate the power spectrum with the premade pacakge"""


    redshifts = np.linspace(5, 15, 100)





    cmFast_hist, width_50_21, width_90_21 = pp.reionization_history(redshifts,z_re_box, comp_width=True)
    #pp.plot_21zreion_ionhist([reion_hist_zreion,cmFast_hist, reion_hist_zreion_0593])
    ionization_rates.append(cmFast_hist)

    nb_bins = 20
    nb_bins = int(nb_bins)

    perturbed_field = p21c.perturb_field(redshift=zre_mean, init_boxes=initial_conditions)
    density_field = perturbed_field.density
    #print(density_field == p21c.run_coeval(redshift = zre_mean, user_params = user_params,cosmo_params = cosmo_params, astro_params = astro_params).density)

    kbins_zre = [0.08570025 , 7.64144032]

    zre_pp = pp.ps_ion_map(overzre, nb_bins, 143, logbins=True)
    den_pp = pp.ps_ion_map(density_field, nb_bins, 143, logbins=True)

    delta = 0.1
    Xd, Yd, overd_fft, freqd = FFT.compute_fft(density_field, delta, box_dim)
    Xd, Yd, overzre_fft, freqd = FFT.compute_fft(overzre, delta, box_dim)
    cross_matrix = overd_fft.conj() * overzre_fft
    #cross_matrix =  overzre_fft.conj().T *overd_fft
    b_mz1 = np.sqrt(np.divide(zre_pp, den_pp))
    #b_mz2 = np.sqrt(np.divide(p_k_zre, p_k_density))

    values_cross, count_cross = sa.average_overk(143,cross_matrix,nb_bins, logbins=True)
    cross_pp = np.divide(values_cross, count_cross)
    # k_values = np.linspace(kbins_zre.min(), kbins_zre.max(), len(cross_pp))
    #k_values = np.linspace(0.08570025, kbins_zre.max(), nb_bins+1)
    k_values = np.logspace(np.log10(0.08570025), np.log10( 7.64144032), nb_bins+1)


    cross_cor = np.divide(cross_pp/8550986.582903482,np.sqrt(((zre_pp/8550986.582903482)*(den_pp/8550986.582903482))))

    """these lines plots the linear bias as a function of the kvalues"""




    '''
    MCMC analysis and posterior distribution on the b_mz 
    '''

    #errs = np.ones_like(b_mz)*0.05

    #no b_mz fitting
    b_mz = b_mz1[1:]
    kbins_zre = k_values[1:]
    cross_cor = cross_cor[1:]

    data_dict = sa.run_MCMC_free_params(kbins_zre,b_mz,cross_cor, zre_mean, data_dict=data_dict, varying_input=varying_input, varying_in_value= Heff)


    data_dict['width50'].append(width_50_21)
    data_dict['width90'].append(width_90_21)
    bmzs.append(b_mz)
    print(ionization_rates)
    print(data_dict)
    x0 = np.linspace(0.06, 10, 1000)
    #y_plot_fit = sa.lin_bias(kvalues, 0.564,0.593,0.185)




print(data_dict)
print(ionization_rates)